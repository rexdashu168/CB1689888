<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂèØËΩâÂÇµÁ´∂ÊãçÊü•Ë©¢Á≥ªÁµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header p {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        .header-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .header-info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .header-info-item:hover {
            background: rgba(255, 255, 255, 0.35);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .header-info-item i {
            font-size: 1.1rem;
        }

        .header-info-item a:hover {
            text-decoration: underline !important;
        }

        .search-section {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .search-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            align-items: flex-end;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            display: block;
            font-weight: 500;
            color: #495057;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .control-group input,
        .control-group select {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .control-group input:focus,
        .control-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5568d3 0%, #6a4190 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .stat-card .label {
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .stat-card .value {
            font-size: 1.6rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-card .subvalue {
            font-size: 0.85rem;
            color: #495057;
            margin-top: 5px;
        }

        .table-container {
            padding: 30px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 0.85rem;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        thead th {
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            white-space: nowrap;
            font-size: 0.8rem;
        }

        tbody tr {
            border-bottom: 1px solid #e9ecef;
            transition: all 0.3s;
        }

        tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tbody tr:hover {
            background: #e7f3ff !important;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
        }

        tbody td {
            padding: 10px 8px;
            text-align: center;
        }

        .positive {
            color: #dc3545;
            font-weight: 600;
        }

        .negative {
            color: #28a745;
            font-weight: 600;
        }

        .neutral {
            color: #6c757d;
        }

        .cb-code {
            color: #667eea;
            font-weight: 600;
            cursor: pointer;
        }

        .cb-code:hover {
            text-decoration: underline;
        }

        .highlight {
            background: #fff3cd !important;
        }

        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-yes {
            background: #d4edda;
            color: #155724;
        }

        .badge-no {
            background: #f8d7da;
            color: #721c24;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #6c757d;
            font-size: 1.1rem;
        }

        .summary-table {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            border: 2px solid #667eea;
        }

        .summary-table h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.2rem;
            text-align: center;
            font-weight: 600;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .summary-item .label {
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .summary-item .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #495057;
        }

        .summary-item .value.highlight {
            color: #667eea;
        }

        .footer {
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 2px solid #e9ecef;
            text-align: center;
            color: #6c757d;
            font-size: 0.85rem;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .search-controls {
                flex-direction: column;
            }

            .control-group {
                width: 100%;
            }

            .stats-cards {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 0.75rem;
            }

            thead th,
            tbody td {
                padding: 8px 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ ÂèØËΩâÂÇµÁ´∂ÊãçÊü•Ë©¢Á≥ªÁµ±</h1>
            <p style="margin-bottom: 15px;">2025Âπ¥5-8ÊúàÁ´∂ÊãçË≥áÊñôÂàÜÊûê | Âç≥ÊôÇÊü•Ë©¢ÂæóÊ®ôÂÉπÊ†ºËàáÊ∫¢ÂÉπÁéá</p>
            <div class="header-info">
                <div class="header-info-item">
                    <span>üìÖ</span>
                    <span id="currentDate">ËºâÂÖ•‰∏≠...</span>
                </div>
                <div class="header-info-item" style="background: rgba(255, 255, 255, 0.25); cursor: pointer;" onclick="window.open('https://vocus.cc/salon/655c9dbcfd897800019d5bb4', '_blank')">
                    <span>üìù</span>
                    <span style="font-weight: 600;">ÊñπÊ†ºÂ≠êÈÉ®ËêΩÊ†º</span>
                </div>
                <div class="header-info-item" style="background: rgba(255, 255, 255, 0.25); cursor: pointer;" onclick="window.open('https://www.youtube.com/@rexdashu168', '_blank')">
                    <span>üé¨</span>
                    <span style="font-weight: 600;">YouTubeÈ†ªÈÅì</span>
                </div>
            </div>
            <p style="margin-top: 12px; font-size: 0.85rem; opacity: 0.85;">by RexÂ§ßÂèîÁöÑ168Âè∞ËÇ°ÊäïË≥áÊïôÂÆ§</p>
        </div>

        <div class="search-section">
            <div class="period-selection" style="margin-bottom: 20px; padding: 20px; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius: 10px; border: 2px solid #e9ecef; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 15px; color: #495057; font-size: 1.1rem; display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 1.3rem;">üìÖ</span>
                    <span>Êü•Ë©¢ÊúüÈñìË®≠ÂÆö</span>
                </h3>
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: flex-end;">
                    <div class="control-group">
                        <label>Ëµ∑ÂßãÊó•Êúü</label>
                        <input type="date" id="startDate" value="2025-05-01">
                    </div>
                    <div class="control-group">
                        <label>ÁµêÊùüÊó•Êúü</label>
                        <input type="date" id="endDate" value="2025-08-31">
                    </div>
                    <div class="control-group">
                        <label>Âø´ÈÄüÈÅ∏Êìá</label>
                        <select id="quickPeriod" onchange="setQuickPeriod()">
                            <option value="">Ëá™Ë®ÇÊúüÈñì</option>
                            <option value="all">ÂÖ®ÈÉ®Ë≥áÊñô</option>
                            <option value="month1">ÊúÄËøë1ÂÄãÊúà</option>
                            <option value="month2">ÊúÄËøë2ÂÄãÊúà</option>
                            <option value="month3">ÊúÄËøë3ÂÄãÊúà</option>
                            <option value="may">5Êúà‰ªΩ</option>
                            <option value="june">6Êúà‰ªΩ</option>
                            <option value="july">7Êúà‰ªΩ</option>
                            <option value="august">8Êúà‰ªΩ</option>
                            <option value="q2">Á¨¨‰∫åÂ≠£(5-6Êúà)</option>
                            <option value="q3">Á¨¨‰∏âÂ≠£(7-8Êúà)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="search-controls">
                <div class="control-group">
                    <label>1. ËÇ°Á•®‰ª£Ëôü</label>
                    <input type="text" id="stockCode" placeholder="‰æãÂ¶Ç: 6117">
                </div>
                <div class="control-group">
                    <label>2. CB‰ª£Ëôü</label>
                    <input type="text" id="cbCode" placeholder="‰æãÂ¶Ç: 61172">
                </div>
                <div class="control-group">
                    <label>3. ÂÖ¨Âè∏ÂêçÁ®±</label>
                    <input type="text" id="companyName" placeholder="‰æãÂ¶Ç: ËøéÂª£">
                </div>
                <div class="control-group">
                    <label>4. ÊúâÁÑ°Êìî‰øù</label>
                    <select id="securityFilter">
                        <option value="">ÂÖ®ÈÉ®</option>
                        <option value="Yes">ÊúâÊìî‰øù</option>
                        <option value="No">ÁÑ°Êìî‰øù</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>5. ÁôºË°åÂπ¥Êúü</label>
                    <select id="periodFilter">
                        <option value="">ÂÖ®ÈÉ®</option>
                        <option value="3Âπ¥">3Âπ¥</option>
                        <option value="5Âπ¥">5Âπ¥</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>6. ÁôºË°åË¶èÊ®°</label>
                    <select id="scaleFilter">
                        <option value="">ÂÖ®ÈÉ®</option>
                        <option value="0-3">3ÂÑÑ‰ª•‰∏ã</option>
                        <option value="3-6">3-6ÂÑÑ</option>
                        <option value="6-10">6-10ÂÑÑ</option>
                        <option value="10-15">10-15ÂÑÑ</option>
                        <option value="15-20">15-20ÂÑÑ</option>
                        <option value="20-999">20ÂÑÑ‰ª•‰∏ä</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>7. ‰ø°Áî®Ë©ïÁ≠â (TCRI)</label>
                    <select id="ratingFilter">
                        <option value="">ÂÖ®ÈÉ®</option>
                        <option value="2">2ÂàÜ</option>
                        <option value="3">3ÂàÜ</option>
                        <option value="4">4ÂàÜ</option>
                        <option value="5">5ÂàÜ</option>
                        <option value="6">6ÂàÜ</option>
                        <option value="7">7ÂàÜ</option>
                        <option value="8">8ÂàÜ</option>
                        <option value="9">9ÂàÜ</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>8. ËÇ°Êú¨ÂçÄÈñì</label>
                    <select id="capitalFilter">
                        <option value="">ÂÖ®ÈÉ®</option>
                        <option value="0-3">3ÂÑÑ‰ª•‰∏ã</option>
                        <option value="3-6">3-6ÂÑÑ</option>
                        <option value="6-10">6-10ÂÑÑ</option>
                        <option value="10-15">10-15ÂÑÑ</option>
                        <option value="15-20">15-20ÂÑÑ</option>
                        <option value="20-999">20ÂÑÑ‰ª•‰∏ä</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>9. Ë®ÇÂÉπÊ∫¢ÂÉπÁéáÂçÄÈñì</label>
                    <select id="pricePremiumFilter">
                        <option value="">ÂÖ®ÈÉ®</option>
                        <option value="0-105">105%‰ª•‰∏ã</option>
                        <option value="105-110">105-110%</option>
                        <option value="110-120">110-120%</option>
                        <option value="120-999">120%‰ª•‰∏ä</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>10. ÊéõÁâåÂæåÊúÄÈ´òÂÉπË°®Áèæ</label>
                    <select id="listHighFilter">
                        <option value="">ÂÖ®ÈÉ®</option>
                        <option value="0-100">100‰ª•‰∏ã</option>
                        <option value="100-110">100-110</option>
                        <option value="110-120">110-120</option>
                        <option value="120-130">120-130</option>
                        <option value="130-150">130-150</option>
                        <option value="150-999">150‰ª•‰∏ä</option>
                    </select>
                </div>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="searchData()">Êü•Ë©¢</button>
                <button class="btn btn-secondary" onclick="resetSearch()">ÈáçÁΩÆ</button>
                <button class="btn btn-success" onclick="exportToExcel()">ÂåØÂá∫Excel</button>
            </div>
        </div>

        <div class="stats-cards">
            <div class="stat-card" style="background: linear-gradient(135deg, #fff5e6 0%, #ffffff 100%); border-left: 4px solid #ff9800;">
                <div class="label">Êü•Ë©¢ÊúüÈñì</div>
                <div class="value" style="font-size: 1.2rem; color: #ff9800;" id="periodRange">-</div>
                <div class="subvalue" id="periodDays">-</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%); border-left: 4px solid #2196f3;">
                <div class="label">Á´∂ÊãçÊ™îÊï∏</div>
                <div class="value" style="color: #2196f3;" id="totalCount">21</div>
            </div>
            <div class="stat-card">
                <div class="label">Á∏ΩÁôºË°åË¶èÊ®°</div>
                <div class="value" id="totalScale">-</div>
                <div class="subvalue">ÂÑÑÂÖÉ</div>
            </div>
            <div class="stat-card">
                <div class="label">Âπ≥ÂùáÁôºË°åË¶èÊ®°</div>
                <div class="value" id="avgScale">-</div>
                <div class="subvalue">ÂÑÑÂÖÉ/Ê™î</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #f3e5f5 0%, #ffffff 100%); border-left: 4px solid #9c27b0;">
                <div class="label">Âπ≥ÂùáÂæóÊ®ôÊ∫¢ÂÉπ</div>
                <div class="value" style="color: #9c27b0;" id="avgPremium">10.2%</div>
                <div class="subvalue">ÁêÜË´ñÂÉπÂ∑ÆË∑ù</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #ffebee 0%, #ffffff 100%); border-left: 4px solid #f44336;">
                <div class="label">ÊúÄÈ´òÂæóÊ®ôÊ∫¢ÂÉπ</div>
                <div class="value" style="color: #f44336;" id="maxPremium">225.5%</div>
                <div class="subvalue" id="maxPremiumName">Á¢©Â§©‰∏â</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #e8f5e9 0%, #ffffff 100%); border-left: 4px solid #4caf50;">
                <div class="label">ÊúÄ‰ΩéÂæóÊ®ôÊ∫¢ÂÉπ</div>
                <div class="value" style="color: #4caf50;" id="minPremium">-6.5%</div>
                <div class="subvalue" id="minPremiumName">ËøéÂª£‰∫å</div>
            </div>
            <div class="stat-card">
                <div class="label">‰∏≠‰ΩçÊï∏Ê∫¢ÂÉπ</div>
                <div class="value" id="medianPremium">-</div>
                <div class="subvalue">50%ÂàÜ‰ΩçÊï∏</div>
            </div>
            <div class="stat-card">
                <div class="label">ÊúâÊìî‰øùÊØî‰æã</div>
                <div class="value" id="securedRatio">19.0%</div>
                <div class="subvalue" id="securedCount">4Ê™î</div>
            </div>
            <div class="stat-card">
                <div class="label">3Âπ¥ÊúüÊØî‰æã</div>
                <div class="value" id="period3Ratio">-</div>
                <div class="subvalue" id="period3Count">-</div>
            </div>
            <div class="stat-card">
                <div class="label">Âπ≥Âùá‰ø°Ë©ïÁ≠âÁ¥ö</div>
                <div class="value" id="avgRating">-</div>
                <div class="subvalue">TCRIË©ïÁ≠â</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #fff3e0 0%, #ffffff 100%); border-left: 4px solid #ff9800;">
                <div class="label">ÊéõÁâåÂæåÂπ≥ÂùáÊº≤ÂπÖ</div>
                <div class="value" style="color: #ff9800;" id="avgListGain">-</div>
                <div class="subvalue">ÊúÄÈ´òÂÉπ vs Âπ≥ÂùáÂæóÊ®ô</div>
            </div>
        </div>

        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>Â∫èËôü</th>
                        <th>ÈñãÊ®ôÊó•Êúü</th>
                        <th>ËÇ°Á•®<br>‰ª£Ëôü</th>
                        <th>CB<br>‰ª£Ëôü</th>
                        <th>ÂêçÁ®±</th>
                        <th>ËÇ°Êú¨<br>(ÂÑÑ)</th>
                        <th>ÁôºË°å<br>Ë¶èÊ®°</th>
                        <th>Âπ¥Êúü</th>
                        <th>Êìî‰øù</th>
                        <th>‰ø°Ë©ï</th>
                        <th>Á´∂Êãç<br>ÂºµÊï∏</th>
                        <th>Â∫ïÊ®ôÂÉπ</th>
                        <th>Êà™Ê®ôÊó•</th>
                        <th>Êà™Ê®ô<br>Êî∂Áõ§ÂÉπ</th>
                        <th>ËΩâÊèõÂÉπ</th>
                        <th>Ë®ÇÂÉπ<br>Ê∫¢ÂÉπÁéá</th>
                        <th>ÁêÜË´ñÂÉπ</th>
                        <th>ÊúÄ‰Ωé<br>ÂæóÊ®ô</th>
                        <th>ÊúÄ‰Ωé<br>Ê∫¢ÂÉπ</th>
                        <th>ÊúÄÈ´ò<br>ÂæóÊ®ô</th>
                        <th>ÊúÄÈ´ò<br>Ê∫¢ÂÉπ</th>
                        <th>Âπ≥Âùá<br>ÂæóÊ®ô</th>
                        <th>Âπ≥Âùá<br>Ê∫¢ÂÉπ</th>
                        <th>ÊéõÁâåÂæå<br>ÊúÄÈ´òÂÉπ</th>
                        <th>ÊéõÁâåÂæå<br>ÊúÄ‰ΩéÂÉπ</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>

            <div id="summarySection" class="summary-table" style="display: none;">
                <h3>üìä ÁØ©ÈÅ∏ÁµêÊûúÁµ±Ë®àÂåØÁ∏Ω</h3>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #667eea; padding-bottom: 5px; display: inline-block;">üìà Âü∫Êú¨Áµ±Ë®à</h4>
                    <div class="summary-grid">
                        <div class="summary-item" style="border-left: 3px solid #667eea;">
                            <div class="label">ÁØ©ÈÅ∏Ê™îÊï∏</div>
                            <div class="value highlight" id="sumCount">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáËÇ°Êú¨</div>
                            <div class="value" id="sumAvgCapital">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáÁôºË°åË¶èÊ®°</div>
                            <div class="value" id="sumAvgScale">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥Âùá‰ø°Ë©ï</div>
                            <div class="value" id="sumAvgRating">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">ÊúâÊìî‰øùÊØî‰æã</div>
                            <div class="value" id="sumSecuredRatio">0%</div>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <h4 style="color: #ff9800; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #ff9800; padding-bottom: 5px; display: inline-block;">üí∞ Á´∂ÊãçÂÉπÊ†ºÁµ±Ë®à</h4>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáÂ∫ïÊ®ôÂÉπ</div>
                            <div class="value" id="sumAvgFloor">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáÁêÜË´ñÂÉπ</div>
                            <div class="value" id="sumAvgTheoretical">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáÊúÄ‰ΩéÂæóÊ®ô</div>
                            <div class="value" id="sumAvgMinBid">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáÊúÄ‰ΩéÊ∫¢ÂÉπ</div>
                            <div class="value" id="sumAvgMinPremium">0%</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáÊúÄÈ´òÂæóÊ®ô</div>
                            <div class="value" id="sumAvgMaxBid">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáÊúÄÈ´òÊ∫¢ÂÉπ</div>
                            <div class="value" id="sumAvgMaxPremium">0%</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #ff9800;">
                            <div class="label">Âπ≥ÂùáÂæóÊ®ôÂÉπ</div>
                            <div class="value highlight" id="sumAvgBid">0</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #ff9800;">
                            <div class="label">Âπ≥ÂùáÂæóÊ®ôÊ∫¢ÂÉπ</div>
                            <div class="value highlight" id="sumAvgPremium">0%</div>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 style="color: #4caf50; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #4caf50; padding-bottom: 5px; display: inline-block;">üéØ ÊéõÁâåË°®ÁèæÁµ±Ë®à</h4>
                    <div class="summary-grid">
                        <div class="summary-item" style="border-left: 3px solid #4caf50;">
                            <div class="label">Âπ≥ÂùáÊéõÁâåÊúÄÈ´ò</div>
                            <div class="value highlight" id="sumAvgListHigh">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">Âπ≥ÂùáÊéõÁâåÊúÄ‰Ωé</div>
                            <div class="value" id="sumAvgListLow">0</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #4caf50;">
                            <div class="label">Âπ≥ÂùáÊéõÁâåÊº≤ÂπÖ</div>
                            <div class="value highlight" id="sumAvgListGain">0%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p style="font-weight: 500;">Ë≥áÊñôÊúüÈñìÔºö2025Âπ¥5Êúà - 8Êúà | Ë≥áÊñô‰æÜÊ∫êÔºöË≠âÂà∏Ê´ÉÊ™ØË≤∑Ë≥£‰∏≠ÂøÉ</p>
            <p style="margin-top: 8px; color: #f44336; font-weight: 500;">‚ö†Ô∏è Êú¨Ë°®ÂÉÖ‰æõÂèÉËÄÉÔºåÊäïË≥áÊ±∫Á≠ñË´ãËá™Ë°åË©ï‰º∞È¢®Èö™</p>
            
            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #dee2e6;">
                <p style="font-weight: 600; color: #495057; margin-bottom: 12px; font-size: 1rem;">
                    üìö RexÂ§ßÂèîÁöÑ168Âè∞ËÇ°ÊäïË≥áÊïôÂÆ§
                </p>
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 12px;">
                    <a href="https://vocus.cc/salon/655c9dbcfd897800019d5bb4" target="_blank" 
                       style="color: white; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                              padding: 8px 20px; border-radius: 20px; text-decoration: none; 
                              font-weight: 600; transition: all 0.3s; display: inline-flex; 
                              align-items: center; gap: 6px; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);"
                       onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.4)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'">
                        <span>üìù</span>
                        <span>ÊñπÊ†ºÂ≠êÈÉ®ËêΩÊ†º</span>
                    </a>
                    <a href="https://www.youtube.com/@rexdashu168" target="_blank"
                       style="color: white; background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%); 
                              padding: 8px 20px; border-radius: 20px; text-decoration: none; 
                              font-weight: 600; transition: all 0.3s; display: inline-flex; 
                              align-items: center; gap: 6px; box-shadow: 0 2px 8px rgba(255, 0, 0, 0.3);"
                       onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(255, 0, 0, 0.4)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(255, 0, 0, 0.3)'">
                        <span>üé¨</span>
                        <span>YouTubeÈ†ªÈÅì</span>
                    </a>
                </div>
                <p style="font-size: 0.85rem; color: #6c757d;">Êõ¥Â§öÊäïË≥áËßÄÂøµËàáÂèØËΩâÂÇµÂàÜÊûêÔºåÊ≠°ËøéË®ÇÈñ±Â≠∏Áøí</p>
            </div>
            
            <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-bottom: 8px;">
                    <div style="font-size: 0.9rem; color: #6c757d; display: flex; align-items: center; gap: 6px;">
                        <span>üëÅÔ∏è</span>
                        <span>‰ªäÊó•ÁÄèË¶ΩÔºö</span>
                        <strong style="color: #667eea; font-size: 1.1rem;" id="todayViews">0</strong>
                    </div>
                    <div style="font-size: 0.9rem; color: #6c757d; display: flex; align-items: center; gap: 6px;">
                        <span>üìä</span>
                        <span>Á¥ØÁ©çÁÄèË¶ΩÔºö</span>
                        <strong style="color: #667eea; font-size: 1.1rem;" id="totalViews">0</strong>
                    </div>
                </div>
                <p style="font-size: 0.75rem; opacity: 0.7;">ÁÄèË¶ΩÈáèÁµ±Ë®àÊé°Áî®Êú¨Âú∞ÂÑ≤Â≠òÔºåÂÉÖË®òÈåÑÊÇ®ÁöÑÁÄèË¶ΩÂô®Ë®™ÂïèÊ¨°Êï∏</p>
            </div>
        </div>
    </div>

    <script>
        // È°ØÁ§∫Áï∂ÂâçÊó•Êúü
        function displayCurrentDate() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            };
            const dateString = now.toLocaleDateString('zh-TW', options);
            document.getElementById('currentDate').textContent = dateString;
        }

        // ÁÄèË¶ΩÈáèËøΩËπ§Á≥ªÁµ±
        function initializeViewCounter() {
            const today = new Date().toLocaleDateString('zh-TW');
            
            // ÂèñÂæó localStorage ‰∏≠ÁöÑË≥áÊñô
            let viewData = JSON.parse(localStorage.getItem('cbAuctionViews') || '{}');
            
            // ÂàùÂßãÂåñË≥áÊñôÁµêÊßã
            if (!viewData.total) {
                viewData.total = 0;
            }
            if (!viewData.daily) {
                viewData.daily = {};
            }
            
            // Â¢ûÂä†Á∏ΩÁÄèË¶ΩÈáè
            viewData.total += 1;
            
            // Â¢ûÂä†‰ªäÊó•ÁÄèË¶ΩÈáè
            if (!viewData.daily[today]) {
                viewData.daily[today] = 0;
            }
            viewData.daily[today] += 1;
            
            // Ê∏ÖÁêÜ30Â§©ÂâçÁöÑË≥áÊñôÔºàÈÅøÂÖç localStorage ÈÅéÂ§ßÔºâ
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            Object.keys(viewData.daily).forEach(date => {
                const dateObj = new Date(date);
                if (dateObj < thirtyDaysAgo) {
                    delete viewData.daily[date];
                }
            });
            
            // ÂÑ≤Â≠òÂõû localStorage
            localStorage.setItem('cbAuctionViews', JSON.stringify(viewData));
            
            // Êõ¥Êñ∞È°ØÁ§∫
            updateViewDisplay(viewData.daily[today], viewData.total);
        }

        // Êõ¥Êñ∞ÁÄèË¶ΩÈáèÈ°ØÁ§∫
        function updateViewDisplay(todayCount, totalCount) {
            // Âä†ÂÖ•ÂãïÁï´ÊïàÊûú
            const todayElement = document.getElementById('todayViews');
            const totalElement = document.getElementById('totalViews');
            
            animateNumber(todayElement, todayCount);
            animateNumber(totalElement, totalCount);
        }

        // Êï∏Â≠óÂãïÁï´ÊïàÊûú
        function animateNumber(element, targetNumber) {
            const duration = 1000; // 1Áßí
            const startNumber = 0;
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const currentNumber = Math.floor(progress * (targetNumber - startNumber) + startNumber);
                element.textContent = currentNumber.toLocaleString();
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }

        // ÂÆåÊï¥Ë≥áÊñô
        const auctionData = [
            {no: 262, date: '2025/5/19', stockCode: '6117', cbCode: '61172', name: 'ËøéÂª£‰∫å', capital: 9.19, scale: '5.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 7, volume: 4250, floor: 100.0, cutoffDate: '2025/5/15', cutoffPrice: 92.00, convPrice: 79.30, pricePremium: '102.00%', theoretical: 116.02, minBid: 108.50, minPremium: -6.5, maxBid: 120.00, maxPremium: 3.4, avgBid: 110.73, avgPremium: -4.6, listHigh: 129.00, listLow: 109.80},
            {no: 263, date: '2025/5/20', stockCode: '1472', cbCode: '14722', name: '‰∏âÊ¥ãÂØ¶Ê•≠‰∫å', capital: 5.25, scale: '3.0ÂÑÑ', period: '3Âπ¥', secured: 'Yes', rating: 7, volume: 2550, floor: 100.0, cutoffDate: '2025/5/16', cutoffPrice: 107.00, convPrice: 102.00, pricePremium: '102.48%', theoretical: 104.90, minBid: 108.36, minPremium: 3.3, maxBid: 115.40, maxPremium: 10.0, avgBid: 110.71, avgPremium: 5.5, listHigh: 110.30, listLow: 104.00},
            {no: 264, date: '2025/5/28', stockCode: '4555', cbCode: '45554', name: 'Ê∞£Á´ãÂõõ', capital: 7.00, scale: '5.0ÂÑÑ', period: '3Âπ¥', secured: 'Yes', rating: 6, volume: 4250, floor: 102.0, cutoffDate: '2025/5/26', cutoffPrice: 41.20, convPrice: 44.00, pricePremium: '104.76%', theoretical: 93.64, minBid: 102.00, minPremium: 8.9, maxBid: 107.11, maxPremium: 14.4, avgBid: 103.28, avgPremium: 10.3, listHigh: 119.50, listLow: 100.00},
            {no: 265, date: '2025/6/4', stockCode: '3653', cbCode: '36535', name: 'ÂÅ•Á≠ñ‰∫î', capital: 14.29, scale: '20.0ÂÑÑ', period: '5Âπ¥', secured: 'No', rating: 3, volume: 17012, floor: 105.0, cutoffDate: '2025/6/2', cutoffPrice: 1320.00, convPrice: 1320.90, pricePremium: '102.00%', theoretical: 99.93, minBid: 106.61, minPremium: 6.7, maxBid: 200.00, maxPremium: 100.1, avgBid: 108.37, avgPremium: 8.4, listHigh: 159.00, listLow: 115.00},
            {no: 266, date: '2025/6/5', stockCode: '3617', cbCode: '36173', name: 'Á¢©Â§©‰∏â', capital: 9.42, scale: '15.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 4, volume: 12750, floor: 100.0, cutoffDate: '2025/6/3', cutoffPrice: 253.00, convPrice: 305.00, pricePremium: '114.66%', theoretical: 82.95, minBid: 100.00, minPremium: 20.6, maxBid: 270.00, maxPremium: 225.5, avgBid: 100.79, avgPremium: 21.5, listHigh: 111.00, listLow: 99.85},
            {no: 267, date: '2025/6/6', stockCode: '2351', cbCode: '23511', name: 'È†ÜÂæ∑‰∏Ä', capital: 18.21, scale: '12.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 5, volume: 10200, floor: 100.0, cutoffDate: '2025/6/4', cutoffPrice: 71.30, convPrice: 75.00, pricePremium: '104.90%', theoretical: 95.07, minBid: 100.14, minPremium: 5.3, maxBid: 107.51, maxPremium: 13.1, avgBid: 102.18, avgPremium: 7.5, listHigh: 132.00, listLow: 102.20},
            {no: 268, date: '2025/6/11', stockCode: '1466', cbCode: '14664', name: 'ËÅöÈöÜÂõõ', capital: 11.12, scale: '4.0ÂÑÑ', period: '3Âπ¥', secured: 'Yes', rating: 7, volume: 3400, floor: 100.0, cutoffDate: '2025/6/9', cutoffPrice: 16.80, convPrice: 18.80, pricePremium: '104.00%', theoretical: 89.36, minBid: 101.00, minPremium: 13.0, maxBid: 108.00, maxPremium: 20.9, avgBid: 103.11, avgPremium: 15.4, listHigh: 107.80, listLow: 103.00},
            {no: 269, date: '2025/6/17', stockCode: '6538', cbCode: '65381', name: 'ÂÄâÂíå‰∏Ä', capital: 3.81, scale: '3.0ÂÑÑ', period: '5Âπ¥', secured: 'No', rating: 5, volume: 2550, floor: 101.0, cutoffDate: '2025/6/13', cutoffPrice: 108.00, convPrice: 112.00, pricePremium: '102.30%', theoretical: 96.43, minBid: 101.30, minPremium: 5.1, maxBid: 106.22, maxPremium: 10.2, avgBid: 102.54, avgPremium: 6.3, listHigh: 101.00, listLow: 92.50},
            {no: 270, date: '2025/6/19', stockCode: '2247', cbCode: '22472', name: 'Ê±éÂæ∑‰∫å', capital: 8.07, scale: '10.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 4, volume: 8500, floor: 101.0, cutoffDate: '2025/6/17', cutoffPrice: 289.00, convPrice: 297.80, pricePremium: '102.50%', theoretical: 97.04, minBid: 101.55, minPremium: 4.6, maxBid: 200.00, maxPremium: 106.1, avgBid: 102.37, avgPremium: 5.5, listHigh: 119.95, listLow: 102.00},
            {no: 271, date: '2025/6/19', stockCode: '2530', cbCode: '25304', name: 'ËèØÂª∫Âõõ', capital: 84.00, scale: '10.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 7, volume: 7180, floor: 100.0, cutoffDate: '2025/6/17', cutoffPrice: 32.45, convPrice: 32.50, pricePremium: '102.30%', theoretical: 99.85, minBid: 100.00, minPremium: 0.2, maxBid: 110.00, maxPremium: 10.2, avgBid: 100.37, avgPremium: 0.5, listHigh: 99.60, listLow: 92.40},
            {no: 272, date: '2025/7/17', stockCode: '6469', cbCode: '64693', name: 'Â§ßÊ®π‰∏â', capital: 14.97, scale: '10.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 4, volume: 8650, floor: 100.0, cutoffDate: '2025/7/15', cutoffPrice: 143.50, convPrice: 149.74, pricePremium: '102.00%', theoretical: 95.83, minBid: 101.51, minPremium: 5.9, maxBid: 109.00, maxPremium: 13.7, avgBid: 102.20, avgPremium: 6.6, listHigh: 118.50, listLow: 108.60},
            {no: 273, date: '2025/7/23', stockCode: '8411', cbCode: '84113', name: 'Á¶èË≤û‰∏âKY', capital: 21.84, scale: '12.0ÂÑÑ', period: '5Âπ¥', secured: 'Yes', rating: 6, volume: 10200, floor: 100.0, cutoffDate: '2025/7/21', cutoffPrice: 13.20, convPrice: 13.40, pricePremium: '103.00%', theoretical: 98.51, minBid: 100.00, minPremium: 1.5, maxBid: 103.60, maxPremium: 5.2, avgBid: 100.49, avgPremium: 2.0, listHigh: 102.30, listLow: 99.30},
            {no: 274, date: '2025/7/24', stockCode: '6982', cbCode: '69822', name: 'Â§ß‰∫ïÊ≥µÊµ¶‰∫å', capital: 4.03, scale: '2.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 7, volume: 1709, floor: 100.0, cutoffDate: '2025/7/22', cutoffPrice: 62.50, convPrice: 61.80, pricePremium: '102.10%', theoretical: 101.13, minBid: 100.00, minPremium: -1.1, maxBid: 109.91, maxPremium: 8.7, avgBid: 101.16, avgPremium: 0.0, listHigh: 120.00, listLow: 102.05},
            {no: 275, date: '2025/7/24', stockCode: '6843', cbCode: '68431', name: 'ÈÄ≤ÂÖ∏‰∏Ä', capital: 3.33, scale: '3.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 6, volume: 2700, floor: 101.0, cutoffDate: '2025/7/22', cutoffPrice: 59.80, convPrice: 61.40, pricePremium: '102.56%', theoretical: 97.39, minBid: 101.01, minPremium: 3.7, maxBid: 105.91, maxPremium: 8.7, avgBid: 101.83, avgPremium: 4.6, listHigh: 114.30, listLow: 102.00},
            {no: 276, date: '2025/7/25', stockCode: '3131', cbCode: '31312', name: 'ÂºòÂ°ë‰∫å', capital: 2.92, scale: '10.0ÂÑÑ', period: '5Âπ¥', secured: 'No', rating: 5, volume: 8500, floor: 103.0, cutoffDate: '2025/7/23', cutoffPrice: 1565.00, convPrice: 1649.20, pricePremium: '102.01%', theoretical: 94.89, minBid: 109.14, minPremium: 15.0, maxBid: 120.00, maxPremium: 26.5, avgBid: 110.50, avgPremium: 16.4, listHigh: 124.00, listLow: 110.30},
            {no: 277, date: '2025/7/28', stockCode: '3167', cbCode: '31672', name: 'Â§ßÈáè‰∫å', capital: 8.84, scale: '5.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 6, volume: 4661, floor: 100.0, cutoffDate: '2025/7/24', cutoffPrice: 168.00, convPrice: 170.00, pricePremium: '108.40%', theoretical: 98.82, minBid: 107.39, minPremium: 8.7, maxBid: 116.88, maxPremium: 18.3, avgBid: 109.09, avgPremium: 10.4, listHigh: 140.25, listLow: 113.00},
            {no: 278, date: '2025/7/28', stockCode: '2641', cbCode: '26418', name: 'Ê≠£Âæ∑ÂÖ´', capital: 32.49, scale: '7.8ÂÑÑ', period: '5Âπ¥', secured: 'No', rating: 6, volume: 7020, floor: 100.5, cutoffDate: '2025/7/24', cutoffPrice: 19.50, convPrice: 19.30, pricePremium: '102.12%', theoretical: 101.04, minBid: 100.50, minPremium: -0.5, maxBid: 109.30, maxPremium: 8.2, avgBid: 101.30, avgPremium: 0.3, listHigh: 110.60, listLow: 100.00},
            {no: 279, date: '2025/8/6', stockCode: '7556', cbCode: '75562', name: 'ÊÑèÂæ∑Â£´‰∫å', capital: 2.73, scale: '2.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 6, volume: 1800, floor: 100.0, cutoffDate: '2025/8/4', cutoffPrice: 174.00, convPrice: 178.50, pricePremium: '102.00%', theoretical: 97.48, minBid: 107.50, minPremium: 10.3, maxBid: 117.00, maxPremium: 20.0, avgBid: 109.25, avgPremium: 12.1, listHigh: 124.85, listLow: 118.00},
            {no: 280, date: '2025/8/6', stockCode: '4581', cbCode: '45811', name: 'ÂÖâÈöÜÁ≤æÂØÜ‰∏ÄKY', capital: 3.39, scale: '5.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 5, volume: 4380, floor: 100.5, cutoffDate: '2025/8/4', cutoffPrice: 52.70, convPrice: 56.70, pricePremium: '102.50%', theoretical: 92.95, minBid: 100.50, minPremium: 8.1, maxBid: 107.92, maxPremium: 16.1, avgBid: 100.94, avgPremium: 8.6, listHigh: 107.05, listLow: 99.95},
            {no: 281, date: '2025/8/19', stockCode: '4558', cbCode: '45581', name: 'ÂØ∂Á∑Ø‰∏Ä', capital: 5.00, scale: '3.0ÂÑÑ', period: '3Âπ¥', secured: 'Yes', rating: 8, volume: 2624, floor: 100.0, cutoffDate: '2025/8/15', cutoffPrice: 27.50, convPrice: 29.80, pricePremium: '102.58%', theoretical: 92.28, minBid: 100.10, minPremium: 8.5, maxBid: 107.00, maxPremium: 15.9, avgBid: 101.17, avgPremium: 9.6, listHigh: 103.00, listLow: 101.00},
            {no: 282, date: '2025/8/19', stockCode: '2743', cbCode: '27431', name: 'Â±±ÂØå‰∏Ä', capital: 3.60, scale: '3.0ÂÑÑ', period: '3Âπ¥', secured: 'No', rating: 4, volume: 2640, floor: 102.0, cutoffDate: '2025/8/15', cutoffPrice: 106.00, convPrice: 135.00, pricePremium: '106.30%', theoretical: 78.52, minBid: 102.00, minPremium: 29.9, maxBid: 110.00, maxPremium: 40.1, avgBid: 102.31, avgPremium: 30.3, listHigh: 103.40, listLow: 102.00}
        ];

        let filteredData = [...auctionData];

        // Âø´ÈÄüÊúüÈñìÈÅ∏Êìá
        function setQuickPeriod() {
            const quickPeriod = document.getElementById('quickPeriod').value;
            const today = new Date('2025-08-31'); // ‰ΩøÁî®Ë≥áÊñôÊúÄÂæåÊó•Êúü‰ΩúÁÇ∫Âü∫Ê∫ñ
            let startDate, endDate;

            switch(quickPeriod) {
                case 'all':
                    startDate = '2025-05-01';
                    endDate = '2025-08-31';
                    break;
                case 'month1':
                    startDate = '2025-08-01';
                    endDate = '2025-08-31';
                    break;
                case 'month2':
                    startDate = '2025-07-01';
                    endDate = '2025-08-31';
                    break;
                case 'month3':
                    startDate = '2025-06-01';
                    endDate = '2025-08-31';
                    break;
                case 'may':
                    startDate = '2025-05-01';
                    endDate = '2025-05-31';
                    break;
                case 'june':
                    startDate = '2025-06-01';
                    endDate = '2025-06-30';
                    break;
                case 'july':
                    startDate = '2025-07-01';
                    endDate = '2025-07-31';
                    break;
                case 'august':
                    startDate = '2025-08-01';
                    endDate = '2025-08-31';
                    break;
                case 'q2':
                    startDate = '2025-05-01';
                    endDate = '2025-06-30';
                    break;
                case 'q3':
                    startDate = '2025-07-01';
                    endDate = '2025-08-31';
                    break;
                default:
                    return;
            }

            document.getElementById('startDate').value = startDate;
            document.getElementById('endDate').value = endDate;
        }

        // Êó•ÊúüÁØÑÂúçÁØ©ÈÅ∏
        function filterByDateRange(data, startDate, endDate) {
            const start = new Date(startDate);
            const end = new Date(endDate);
            
            return data.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate >= start && itemDate <= end;
            });
        }

        // ÂçÄÈñìÁØ©ÈÅ∏ËºîÂä©ÂáΩÊï∏
        function isInRange(value, rangeStr) {
            if (!rangeStr) return true;
            
            const [min, max] = rangeStr.split('-').map(Number);
            return value >= min && value < max;
        }

        // ÁôºË°åË¶èÊ®°ÁØ©ÈÅ∏
        function filterByScale(item, scaleFilter) {
            if (!scaleFilter) return true;
            
            const scale = parseFloat(item.scale.replace('ÂÑÑ', ''));
            return isInRange(scale, scaleFilter);
        }

        // ËÇ°Êú¨ÁØ©ÈÅ∏
        function filterByCapital(item, capitalFilter) {
            if (!capitalFilter) return true;
            
            return isInRange(item.capital, capitalFilter);
        }

        // ‰ø°Ë©ïÁØ©ÈÅ∏
        function filterByRating(item, ratingFilter) {
            if (!ratingFilter) return true;
            
            return item.rating === parseInt(ratingFilter);
        }

        // Ë®ÇÂÉπÊ∫¢ÂÉπÁéáÁØ©ÈÅ∏
        function filterByPricePremium(item, pricePremiumFilter) {
            if (!pricePremiumFilter) return true;
            
            // Â∞á "102.00%" ËΩâÊèõÁÇ∫Êï∏Â≠ó 102
            const premiumValue = parseFloat(item.pricePremium.replace('%', ''));
            return isInRange(premiumValue, pricePremiumFilter);
        }

        // ÊéõÁâåÊúÄÈ´òÂÉπÁØ©ÈÅ∏
        function filterByListHigh(item, listHighFilter) {
            if (!listHighFilter) return true;
            
            return isInRange(item.listHigh, listHighFilter);
        }

        // ÂàùÂßãÂåñÈ°ØÁ§∫
        function init() {
            displayCurrentDate();
            initializeViewCounter();
            displayData(filteredData);
            updateStats(filteredData);
            updateSummary(filteredData);
        }

        // È°ØÁ§∫Ë≥áÊñô
        function displayData(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            data.forEach(item => {
                const row = document.createElement('tr');
                const minPremiumClass = item.minPremium >= 0 ? 'positive' : 'negative';
                const maxPremiumClass = item.maxPremium >= 0 ? 'positive' : 'negative';
                const avgPremiumClass = item.avgPremium >= 0 ? 'positive' : 'negative';

                row.innerHTML = `
                    <td>${item.no}</td>
                    <td>${item.date}</td>
                    <td class="cb-code">${item.stockCode}</td>
                    <td class="cb-code">${item.cbCode}</td>
                    <td style="text-align: left; white-space: nowrap;">${item.name}</td>
                    <td>${item.capital}</td>
                    <td>${item.scale}</td>
                    <td>${item.period}</td>
                    <td><span class="badge ${item.secured === 'Yes' ? 'badge-yes' : 'badge-no'}">${item.secured === 'Yes' ? 'Êúâ' : 'ÁÑ°'}</span></td>
                    <td>${item.rating}</td>
                    <td>${item.volume.toLocaleString()}</td>
                    <td>${item.floor.toFixed(1)}</td>
                    <td>${item.cutoffDate}</td>
                    <td>${item.cutoffPrice.toFixed(2)}</td>
                    <td>${item.convPrice.toFixed(2)}</td>
                    <td>${item.pricePremium}</td>
                    <td>${item.theoretical.toFixed(2)}</td>
                    <td>${item.minBid.toFixed(2)}</td>
                    <td class="${minPremiumClass}">${item.minPremium.toFixed(1)}%</td>
                    <td>${item.maxBid.toFixed(2)}</td>
                    <td class="${maxPremiumClass}">${item.maxPremium.toFixed(1)}%</td>
                    <td>${item.avgBid.toFixed(2)}</td>
                    <td class="${avgPremiumClass}">${item.avgPremium.toFixed(1)}%</td>
                    <td>${item.listHigh.toFixed(2)}</td>
                    <td>${item.listLow.toFixed(2)}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // Êõ¥Êñ∞Áµ±Ë®à
        function updateStats(data) {
            if (data.length === 0) {
                // Â¶ÇÊûúÊ≤íÊúâË≥áÊñôÔºåÈ°ØÁ§∫Á©∫ÂÄº
                document.getElementById('periodRange').textContent = 'ÁÑ°Ë≥áÊñô';
                document.getElementById('periodDays').textContent = '';
                document.getElementById('totalCount').textContent = '0';
                document.getElementById('totalScale').textContent = '-';
                document.getElementById('avgScale').textContent = '-';
                document.getElementById('avgPremium').textContent = '-';
                document.getElementById('maxPremium').textContent = '-';
                document.getElementById('minPremium').textContent = '-';
                document.getElementById('medianPremium').textContent = '-';
                document.getElementById('securedRatio').textContent = '-';
                document.getElementById('period3Ratio').textContent = '-';
                document.getElementById('avgRating').textContent = '-';
                document.getElementById('avgListGain').textContent = '-';
                return;
            }

            // Êü•Ë©¢ÊúüÈñì
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const start = new Date(startDate);
            const end = new Date(endDate);
            const daysDiff = Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;
            
            document.getElementById('periodRange').textContent = 
                `${start.getMonth()+1}/${start.getDate()} - ${end.getMonth()+1}/${end.getDate()}`;
            document.getElementById('periodDays').textContent = `${daysDiff}Â§©`;

            // Á∏ΩÊ™îÊï∏
            document.getElementById('totalCount').textContent = data.length;
            
            // Á∏ΩÁôºË°åË¶èÊ®°ÂíåÂπ≥ÂùáË¶èÊ®°
            const totalScale = data.reduce((sum, item) => {
                const scale = parseFloat(item.scale.replace('ÂÑÑ', ''));
                return sum + scale;
            }, 0);
            document.getElementById('totalScale').textContent = totalScale.toFixed(1);
            document.getElementById('avgScale').textContent = (totalScale / data.length).toFixed(1);

            // Âπ≥ÂùáÂæóÊ®ôÊ∫¢ÂÉπ
            const avgPremium = data.reduce((sum, item) => sum + item.avgPremium, 0) / data.length;
            document.getElementById('avgPremium').textContent = avgPremium.toFixed(1) + '%';

            // ÊúÄÈ´òÂæóÊ®ôÊ∫¢ÂÉπ
            const maxPremiumItem = data.reduce((max, item) => item.maxPremium > max.maxPremium ? item : max);
            document.getElementById('maxPremium').textContent = maxPremiumItem.maxPremium.toFixed(1) + '%';
            document.getElementById('maxPremiumName').textContent = maxPremiumItem.name;

            // ÊúÄ‰ΩéÂæóÊ®ôÊ∫¢ÂÉπ
            const minPremiumItem = data.reduce((min, item) => item.minPremium < min.minPremium ? item : min);
            document.getElementById('minPremium').textContent = minPremiumItem.minPremium.toFixed(1) + '%';
            document.getElementById('minPremiumName').textContent = minPremiumItem.name;

            // ‰∏≠‰ΩçÊï∏Ê∫¢ÂÉπ
            const sortedPremiums = data.map(item => item.avgPremium).sort((a, b) => a - b);
            const medianIndex = Math.floor(sortedPremiums.length / 2);
            const medianPremium = sortedPremiums.length % 2 === 0 
                ? (sortedPremiums[medianIndex - 1] + sortedPremiums[medianIndex]) / 2
                : sortedPremiums[medianIndex];
            document.getElementById('medianPremium').textContent = medianPremium.toFixed(1) + '%';

            // ÊúâÊìî‰øùÊØî‰æã
            const securedCount = data.filter(item => item.secured === 'Yes').length;
            const securedRatio = (securedCount / data.length * 100).toFixed(1);
            document.getElementById('securedRatio').textContent = securedRatio + '%';
            document.getElementById('securedCount').textContent = `${securedCount}Ê™î`;

            // 3Âπ¥ÊúüÊØî‰æã
            const period3Count = data.filter(item => item.period === '3Âπ¥').length;
            const period3Ratio = (period3Count / data.length * 100).toFixed(1);
            document.getElementById('period3Ratio').textContent = period3Ratio + '%';
            document.getElementById('period3Count').textContent = `${period3Count}Ê™î`;

            // Âπ≥Âùá‰ø°Ë©ïÁ≠âÁ¥ö
            const avgRating = data.reduce((sum, item) => sum + item.rating, 0) / data.length;
            document.getElementById('avgRating').textContent = avgRating.toFixed(1);

            // ÊéõÁâåÂæåÂπ≥ÂùáÊº≤ÂπÖ
            const avgListGain = data.reduce((sum, item) => {
                const gain = ((item.listHigh - item.avgBid) / item.avgBid * 100);
                return sum + gain;
            }, 0) / data.length;
            document.getElementById('avgListGain').textContent = avgListGain.toFixed(1) + '%';
        }

        // Êü•Ë©¢ÂäüËÉΩ
        function searchData() {
            const stockCode = document.getElementById('stockCode').value.trim();
            const cbCode = document.getElementById('cbCode').value.trim();
            const companyName = document.getElementById('companyName').value.trim();
            const securityFilter = document.getElementById('securityFilter').value;
            const periodFilter = document.getElementById('periodFilter').value;
            const scaleFilter = document.getElementById('scaleFilter').value;
            const ratingFilter = document.getElementById('ratingFilter').value;
            const capitalFilter = document.getElementById('capitalFilter').value;
            const pricePremiumFilter = document.getElementById('pricePremiumFilter').value;
            const listHighFilter = document.getElementById('listHighFilter').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            // ÂÖà‰æùÊó•ÊúüÁØÑÂúçÁØ©ÈÅ∏
            filteredData = filterByDateRange(auctionData, startDate, endDate);

            // ÂÜç‰æùÂÖ∂‰ªñÊ¢ù‰ª∂ÁØ©ÈÅ∏
            filteredData = filteredData.filter(item => {
                const matchStock = !stockCode || item.stockCode.includes(stockCode);
                const matchCB = !cbCode || item.cbCode.includes(cbCode);
                const matchName = !companyName || item.name.includes(companyName);
                const matchSecurity = !securityFilter || item.secured === securityFilter;
                const matchPeriod = !periodFilter || item.period === periodFilter;
                const matchScale = filterByScale(item, scaleFilter);
                const matchRating = filterByRating(item, ratingFilter);
                const matchCapital = filterByCapital(item, capitalFilter);
                const matchPricePremium = filterByPricePremium(item, pricePremiumFilter);
                const matchListHigh = filterByListHigh(item, listHighFilter);

                return matchStock && matchCB && matchName && matchSecurity && 
                       matchPeriod && matchScale && matchRating && matchCapital &&
                       matchPricePremium && matchListHigh;
            });

            displayData(filteredData);
            updateStats(filteredData);
            updateSummary(filteredData);

            // È°ØÁ§∫ÁØ©ÈÅ∏ÁµêÊûúÊèêÁ§∫
            if (filteredData.length === 0) {
                alert('Êü•ÁÑ°Á¨¶ÂêàÊ¢ù‰ª∂ÁöÑË≥áÊñôÔºåË´ãË™øÊï¥ÁØ©ÈÅ∏Ê¢ù‰ª∂');
            }

            // ÈáçÁΩÆÂø´ÈÄüÈÅ∏Êìá‰∏ãÊãâÈÅ∏ÂñÆ
            document.getElementById('quickPeriod').value = '';
        }

        // Êõ¥Êñ∞Áµ±Ë®àÂåØÁ∏Ω
        function updateSummary(data) {
            const summarySection = document.getElementById('summarySection');
            
            if (data.length === 0) {
                summarySection.style.display = 'none';
                return;
            }

            summarySection.style.display = 'block';

            // ÁØ©ÈÅ∏Ê™îÊï∏
            document.getElementById('sumCount').textContent = data.length;

            // Âπ≥ÂùáËÇ°Êú¨
            const avgCapital = data.reduce((sum, item) => sum + item.capital, 0) / data.length;
            document.getElementById('sumAvgCapital').textContent = avgCapital.toFixed(2) + 'ÂÑÑ';

            // Âπ≥ÂùáÁôºË°åË¶èÊ®°
            const avgScale = data.reduce((sum, item) => {
                const scale = parseFloat(item.scale.replace('ÂÑÑ', ''));
                return sum + scale;
            }, 0) / data.length;
            document.getElementById('sumAvgScale').textContent = avgScale.toFixed(2) + 'ÂÑÑ';

            // Âπ≥Âùá‰ø°Ë©ï
            const avgRating = data.reduce((sum, item) => sum + item.rating, 0) / data.length;
            document.getElementById('sumAvgRating').textContent = avgRating.toFixed(2) + 'ÂàÜ';

            // Âπ≥ÂùáÂ∫ïÊ®ôÂÉπ
            const avgFloor = data.reduce((sum, item) => sum + item.floor, 0) / data.length;
            document.getElementById('sumAvgFloor').textContent = avgFloor.toFixed(2);

            // Âπ≥ÂùáÁêÜË´ñÂÉπ
            const avgTheoretical = data.reduce((sum, item) => sum + item.theoretical, 0) / data.length;
            document.getElementById('sumAvgTheoretical').textContent = avgTheoretical.toFixed(2);

            // Âπ≥ÂùáÊúÄ‰ΩéÂæóÊ®ô
            const avgMinBid = data.reduce((sum, item) => sum + item.minBid, 0) / data.length;
            document.getElementById('sumAvgMinBid').textContent = avgMinBid.toFixed(2);

            // Âπ≥ÂùáÊúÄ‰ΩéÊ∫¢ÂÉπ
            const avgMinPremium = data.reduce((sum, item) => sum + item.minPremium, 0) / data.length;
            document.getElementById('sumAvgMinPremium').textContent = avgMinPremium.toFixed(2) + '%';

            // Âπ≥ÂùáÊúÄÈ´òÂæóÊ®ô
            const avgMaxBid = data.reduce((sum, item) => sum + item.maxBid, 0) / data.length;
            document.getElementById('sumAvgMaxBid').textContent = avgMaxBid.toFixed(2);

            // Âπ≥ÂùáÊúÄÈ´òÊ∫¢ÂÉπ
            const avgMaxPremium = data.reduce((sum, item) => sum + item.maxPremium, 0) / data.length;
            document.getElementById('sumAvgMaxPremium').textContent = avgMaxPremium.toFixed(2) + '%';

            // Âπ≥ÂùáÂæóÊ®ôÂÉπ
            const avgBid = data.reduce((sum, item) => sum + item.avgBid, 0) / data.length;
            document.getElementById('sumAvgBid').textContent = avgBid.toFixed(2);

            // Âπ≥ÂùáÂæóÊ®ôÊ∫¢ÂÉπ
            const avgPremium = data.reduce((sum, item) => sum + item.avgPremium, 0) / data.length;
            document.getElementById('sumAvgPremium').textContent = avgPremium.toFixed(2) + '%';

            // Âπ≥ÂùáÊéõÁâåÊúÄÈ´ò
            const avgListHigh = data.reduce((sum, item) => sum + item.listHigh, 0) / data.length;
            document.getElementById('sumAvgListHigh').textContent = avgListHigh.toFixed(2);

            // Âπ≥ÂùáÊéõÁâåÊúÄ‰Ωé
            const avgListLow = data.reduce((sum, item) => sum + item.listLow, 0) / data.length;
            document.getElementById('sumAvgListLow').textContent = avgListLow.toFixed(2);

            // Âπ≥ÂùáÊéõÁâåÊº≤ÂπÖ
            const avgListGain = data.reduce((sum, item) => {
                const gain = ((item.listHigh - item.avgBid) / item.avgBid * 100);
                return sum + gain;
            }, 0) / data.length;
            document.getElementById('sumAvgListGain').textContent = avgListGain.toFixed(2) + '%';

            // ÊúâÊìî‰øùÊØî‰æã
            const securedCount = data.filter(item => item.secured === 'Yes').length;
            const securedRatio = (securedCount / data.length * 100);
            document.getElementById('sumSecuredRatio').textContent = securedRatio.toFixed(1) + '%';
        }

        // ÈáçÁΩÆÂäüËÉΩ
        function resetSearch() {
            document.getElementById('stockCode').value = '';
            document.getElementById('cbCode').value = '';
            document.getElementById('companyName').value = '';
            document.getElementById('securityFilter').value = '';
            document.getElementById('periodFilter').value = '';
            document.getElementById('scaleFilter').value = '';
            document.getElementById('ratingFilter').value = '';
            document.getElementById('capitalFilter').value = '';
            document.getElementById('pricePremiumFilter').value = '';
            document.getElementById('listHighFilter').value = '';
            document.getElementById('startDate').value = '2025-05-01';
            document.getElementById('endDate').value = '2025-08-31';
            document.getElementById('quickPeriod').value = '';

            filteredData = [...auctionData];
            displayData(filteredData);
            updateStats(filteredData);
            updateSummary(filteredData);
        }

        // ÂåØÂá∫ÂäüËÉΩ
        function exportToExcel() {
            alert('ÂåØÂá∫ÂäüËÉΩÈñãÁôº‰∏≠\n\nÁõÆÂâçÈ°ØÁ§∫ ' + filteredData.length + ' Á≠ÜË≥áÊñô');
        }

        // È†ÅÈù¢ËºâÂÖ•ÊôÇÂàùÂßãÂåñ
        window.onload = init;
    </script>
</body>
</html>