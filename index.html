<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯è½‰å‚µç«¶æ‹æŸ¥è©¢ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .header p {
            font-size: 0.95rem;
            opacity: 0.9;
        }

        .header-info {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .header-info-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .header-info-item:hover {
            background: rgba(255, 255, 255, 0.35);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .header-info-item i {
            font-size: 1.1rem;
        }

        .header-info-item a:hover {
            text-decoration: underline !important;
        }

        .search-section {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .search-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            align-items: flex-end;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            display: block;
            font-weight: 500;
            color: #495057;
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .control-group input,
        .control-group select {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .control-group input:focus,
        .control-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 10px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5568d3 0%, #6a4190 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: all 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .stat-card .label {
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .stat-card .value {
            font-size: 1.6rem;
            font-weight: 700;
            color: #667eea;
        }

        .stat-card .subvalue {
            font-size: 0.85rem;
            color: #495057;
            margin-top: 5px;
        }

        .table-container {
            padding: 30px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 0.85rem;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        thead th {
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            white-space: nowrap;
            font-size: 0.8rem;
        }

        tbody tr {
            border-bottom: 1px solid #e9ecef;
            transition: all 0.3s;
        }

        tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        tbody tr:hover {
            background: #e7f3ff !important;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
        }

        tbody td {
            padding: 10px 8px;
            text-align: center;
        }

        .positive {
            color: #dc3545;
            font-weight: 600;
        }

        .negative {
            color: #28a745;
            font-weight: 600;
        }

        .neutral {
            color: #6c757d;
        }

        .cb-code {
            color: #667eea;
            font-weight: 600;
            cursor: pointer;
        }

        .cb-code:hover {
            text-decoration: underline;
        }

        .highlight {
            background: #fff3cd !important;
        }

        .badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-yes {
            background: #d4edda;
            color: #155724;
        }

        .badge-no {
            background: #f8d7da;
            color: #721c24;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #6c757d;
            font-size: 1.1rem;
        }

        .summary-table {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            border: 2px solid #667eea;
        }

        .summary-table h3 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.2rem;
            text-align: center;
            font-weight: 600;
        }

        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .summary-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .summary-item .label {
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .summary-item .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #495057;
        }

        .summary-item .value.highlight {
            color: #667eea;
        }

        .footer {
            padding: 20px 30px;
            background: #f8f9fa;
            border-top: 2px solid #e9ecef;
            text-align: center;
            color: #6c757d;
            font-size: 0.85rem;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .search-controls {
                flex-direction: column;
            }

            .control-group {
                width: 100%;
            }

            .stats-cards {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 0.75rem;
            }

            thead th,
            tbody td {
                padding: 8px 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ å¯è½‰å‚µç«¶æ‹æŸ¥è©¢ç³»çµ±</h1>
            <p style="margin-bottom: 15px;">2025å¹´5-8æœˆç«¶æ‹è³‡æ–™åˆ†æ | å³æ™‚æŸ¥è©¢å¾—æ¨™åƒ¹æ ¼èˆ‡æº¢åƒ¹ç‡</p>
            <div class="header-info">
                <div class="header-info-item">
                    <span>ğŸ“…</span>
                    <span id="currentDate">è¼‰å…¥ä¸­...</span>
                </div>
                <div class="header-info-item" style="background: rgba(255, 255, 255, 0.25); cursor: pointer;" onclick="window.open('https://vocus.cc/salon/655c9dbcfd897800019d5bb4', '_blank')">
                    <span>ğŸ“</span>
                    <span style="font-weight: 600;">æ–¹æ ¼å­éƒ¨è½æ ¼</span>
                </div>
                <div class="header-info-item" style="background: rgba(255, 255, 255, 0.25); cursor: pointer;" onclick="window.open('https://www.youtube.com/@rexdashu168', '_blank')">
                    <span>ğŸ¬</span>
                    <span style="font-weight: 600;">YouTubeé »é“</span>
                </div>
            </div>
            <p style="margin-top: 12px; font-size: 0.85rem; opacity: 0.85;">by Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤</p>
        </div>

        <div class="search-section">
            <div class="period-selection" style="margin-bottom: 20px; padding: 20px; background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%); border-radius: 10px; border: 2px solid #e9ecef; box-shadow: 0 2px 8px rgba(0,0,0,0.05);">
                <h3 style="margin-bottom: 15px; color: #495057; font-size: 1.1rem; display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 1.3rem;">ğŸ“…</span>
                    <span>æŸ¥è©¢æœŸé–“è¨­å®š</span>
                </h3>
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: flex-end;">
                    <div class="control-group">
                        <label>èµ·å§‹æ—¥æœŸ</label>
                        <input type="date" id="startDate" value="2025-05-01">
                    </div>
                    <div class="control-group">
                        <label>çµæŸæ—¥æœŸ</label>
                        <input type="date" id="endDate" value="2025-08-31">
                    </div>
                    <div class="control-group">
                        <label>å¿«é€Ÿé¸æ“‡</label>
                        <select id="quickPeriod" onchange="setQuickPeriod()">
                            <option value="">è‡ªè¨‚æœŸé–“</option>
                            <option value="all">å…¨éƒ¨è³‡æ–™</option>
                            <option value="month1">æœ€è¿‘1å€‹æœˆ</option>
                            <option value="month2">æœ€è¿‘2å€‹æœˆ</option>
                            <option value="month3">æœ€è¿‘3å€‹æœˆ</option>
                            <option value="may">5æœˆä»½</option>
                            <option value="june">6æœˆä»½</option>
                            <option value="july">7æœˆä»½</option>
                            <option value="august">8æœˆä»½</option>
                            <option value="q2">ç¬¬äºŒå­£(5-6æœˆ)</option>
                            <option value="q3">ç¬¬ä¸‰å­£(7-8æœˆ)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="search-controls">
                <div class="control-group">
                    <label>1. è‚¡ç¥¨ä»£è™Ÿ</label>
                    <input type="text" id="stockCode" placeholder="ä¾‹å¦‚: 6117">
                </div>
                <div class="control-group">
                    <label>2. CBä»£è™Ÿ</label>
                    <input type="text" id="cbCode" placeholder="ä¾‹å¦‚: 61172">
                </div>
                <div class="control-group">
                    <label>3. å…¬å¸åç¨±</label>
                    <input type="text" id="companyName" placeholder="ä¾‹å¦‚: è¿å»£">
                </div>
                <div class="control-group">
                    <label>4. æœ‰ç„¡æ“”ä¿</label>
                    <select id="securityFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="Yes">æœ‰æ“”ä¿</option>
                        <option value="No">ç„¡æ“”ä¿</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>5. ç™¼è¡Œå¹´æœŸ</label>
                    <select id="periodFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="3å¹´">3å¹´</option>
                        <option value="5å¹´">5å¹´</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>6. ç™¼è¡Œè¦æ¨¡</label>
                    <select id="scaleFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="0-3">3å„„ä»¥ä¸‹</option>
                        <option value="3-6">3-6å„„</option>
                        <option value="6-10">6-10å„„</option>
                        <option value="10-15">10-15å„„</option>
                        <option value="15-20">15-20å„„</option>
                        <option value="20-999">20å„„ä»¥ä¸Š</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>7. ä¿¡ç”¨è©•ç­‰ (TCRI)</label>
                    <select id="ratingFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="2">2åˆ†</option>
                        <option value="3">3åˆ†</option>
                        <option value="4">4åˆ†</option>
                        <option value="5">5åˆ†</option>
                        <option value="6">6åˆ†</option>
                        <option value="7">7åˆ†</option>
                        <option value="8">8åˆ†</option>
                        <option value="9">9åˆ†</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>8. è‚¡æœ¬å€é–“</label>
                    <select id="capitalFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="0-3">3å„„ä»¥ä¸‹</option>
                        <option value="3-6">3-6å„„</option>
                        <option value="6-10">6-10å„„</option>
                        <option value="10-15">10-15å„„</option>
                        <option value="15-20">15-20å„„</option>
                        <option value="20-999">20å„„ä»¥ä¸Š</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>9. è¨‚åƒ¹æº¢åƒ¹ç‡å€é–“</label>
                    <select id="pricePremiumFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="0-105">105%ä»¥ä¸‹</option>
                        <option value="105-110">105-110%</option>
                        <option value="110-120">110-120%</option>
                        <option value="120-999">120%ä»¥ä¸Š</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>10. æ›ç‰Œå¾Œæœ€é«˜åƒ¹è¡¨ç¾</label>
                    <select id="listHighFilter">
                        <option value="">å…¨éƒ¨</option>
                        <option value="0-100">100ä»¥ä¸‹</option>
                        <option value="100-110">100-110</option>
                        <option value="110-120">110-120</option>
                        <option value="120-130">120-130</option>
                        <option value="130-150">130-150</option>
                        <option value="150-999">150ä»¥ä¸Š</option>
                    </select>
                </div>
            </div>
            <div class="btn-group">
                <button class="btn btn-primary" onclick="searchData()">æŸ¥è©¢</button>
                <button class="btn btn-secondary" onclick="resetSearch()">é‡ç½®</button>
                <button class="btn btn-success" onclick="exportToExcel()">åŒ¯å‡ºExcel</button>
            </div>
        </div>

        <div class="stats-cards">
            <div class="stat-card" style="background: linear-gradient(135deg, #fff5e6 0%, #ffffff 100%); border-left: 4px solid #ff9800;">
                <div class="label">æŸ¥è©¢æœŸé–“</div>
                <div class="value" style="font-size: 1.2rem; color: #ff9800;" id="periodRange">-</div>
                <div class="subvalue" id="periodDays">-</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%); border-left: 4px solid #2196f3;">
                <div class="label">ç«¶æ‹æª”æ•¸</div>
                <div class="value" style="color: #2196f3;" id="totalCount">21</div>
            </div>
            <div class="stat-card">
                <div class="label">ç¸½ç™¼è¡Œè¦æ¨¡</div>
                <div class="value" id="totalScale">-</div>
                <div class="subvalue">å„„å…ƒ</div>
            </div>
            <div class="stat-card">
                <div class="label">å¹³å‡ç™¼è¡Œè¦æ¨¡</div>
                <div class="value" id="avgScale">-</div>
                <div class="subvalue">å„„å…ƒ/æª”</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #f3e5f5 0%, #ffffff 100%); border-left: 4px solid #9c27b0;">
                <div class="label">å¹³å‡å¾—æ¨™æº¢åƒ¹</div>
                <div class="value" style="color: #9c27b0;" id="avgPremium">10.2%</div>
                <div class="subvalue">ç†è«–åƒ¹å·®è·</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #ffebee 0%, #ffffff 100%); border-left: 4px solid #f44336;">
                <div class="label">æœ€é«˜å¾—æ¨™æº¢åƒ¹</div>
                <div class="value" style="color: #f44336;" id="maxPremium">225.5%</div>
                <div class="subvalue" id="maxPremiumName">ç¢©å¤©ä¸‰</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #e8f5e9 0%, #ffffff 100%); border-left: 4px solid #4caf50;">
                <div class="label">æœ€ä½å¾—æ¨™æº¢åƒ¹</div>
                <div class="value" style="color: #4caf50;" id="minPremium">-6.5%</div>
                <div class="subvalue" id="minPremiumName">è¿å»£äºŒ</div>
            </div>
            <div class="stat-card">
                <div class="label">ä¸­ä½æ•¸æº¢åƒ¹</div>
                <div class="value" id="medianPremium">-</div>
                <div class="subvalue">50%åˆ†ä½æ•¸</div>
            </div>
            <div class="stat-card">
                <div class="label">æœ‰æ“”ä¿æ¯”ä¾‹</div>
                <div class="value" id="securedRatio">19.0%</div>
                <div class="subvalue" id="securedCount">4æª”</div>
            </div>
            <div class="stat-card">
                <div class="label">3å¹´æœŸæ¯”ä¾‹</div>
                <div class="value" id="period3Ratio">-</div>
                <div class="subvalue" id="period3Count">-</div>
            </div>
            <div class="stat-card">
                <div class="label">å¹³å‡ä¿¡è©•ç­‰ç´š</div>
                <div class="value" id="avgRating">-</div>
                <div class="subvalue">TCRIè©•ç­‰</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #fff3e0 0%, #ffffff 100%); border-left: 4px solid #ff9800;">
                <div class="label">æ›ç‰Œå¾Œå¹³å‡æ¼²å¹…</div>
                <div class="value" style="color: #ff9800;" id="avgListGain">-</div>
                <div class="subvalue">æœ€é«˜åƒ¹ vs å¹³å‡å¾—æ¨™</div>
            </div>
        </div>

        <div class="table-container">
            <table id="dataTable">
                <thead>
                    <tr>
                        <th>åºè™Ÿ</th>
                        <th>é–‹æ¨™æ—¥æœŸ</th>
                        <th>è‚¡ç¥¨<br>ä»£è™Ÿ</th>
                        <th>CB<br>ä»£è™Ÿ</th>
                        <th>åç¨±</th>
                        <th>è‚¡æœ¬<br>(å„„)</th>
                        <th>ç™¼è¡Œ<br>è¦æ¨¡</th>
                        <th>å¹´æœŸ</th>
                        <th>æ“”ä¿</th>
                        <th>ä¿¡è©•</th>
                        <th>ç«¶æ‹<br>å¼µæ•¸</th>
                        <th>åº•æ¨™åƒ¹</th>
                        <th>æˆªæ¨™æ—¥</th>
                        <th>æˆªæ¨™<br>æ”¶ç›¤åƒ¹</th>
                        <th>è½‰æ›åƒ¹</th>
                        <th>è¨‚åƒ¹<br>æº¢åƒ¹ç‡</th>
                        <th>ç†è«–åƒ¹</th>
                        <th>æœ€ä½<br>å¾—æ¨™</th>
                        <th>æœ€ä½<br>æº¢åƒ¹</th>
                        <th>æœ€é«˜<br>å¾—æ¨™</th>
                        <th>æœ€é«˜<br>æº¢åƒ¹</th>
                        <th>å¹³å‡<br>å¾—æ¨™</th>
                        <th>å¹³å‡<br>æº¢åƒ¹</th>
                        <th>æ›ç‰Œå¾Œ<br>æœ€é«˜åƒ¹</th>
                        <th>æ›ç‰Œå¾Œ<br>æœ€ä½åƒ¹</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                </tbody>
            </table>

            <div id="summarySection" class="summary-table" style="display: none;">
                <h3>ğŸ“Š ç¯©é¸çµæœçµ±è¨ˆåŒ¯ç¸½</h3>
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #667eea; padding-bottom: 5px; display: inline-block;">ğŸ“ˆ åŸºæœ¬çµ±è¨ˆ</h4>
                    <div class="summary-grid">
                        <div class="summary-item" style="border-left: 3px solid #667eea;">
                            <div class="label">ç¯©é¸æª”æ•¸</div>
                            <div class="value highlight" id="sumCount">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡è‚¡æœ¬</div>
                            <div class="value" id="sumAvgCapital">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡ç™¼è¡Œè¦æ¨¡</div>
                            <div class="value" id="sumAvgScale">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡ä¿¡è©•</div>
                            <div class="value" id="sumAvgRating">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">æœ‰æ“”ä¿æ¯”ä¾‹</div>
                            <div class="value" id="sumSecuredRatio">0%</div>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <h4 style="color: #ff9800; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #ff9800; padding-bottom: 5px; display: inline-block;">ğŸ’° ç«¶æ‹åƒ¹æ ¼çµ±è¨ˆ</h4>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="label">å¹³å‡åº•æ¨™åƒ¹</div>
                            <div class="value" id="sumAvgFloor">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡ç†è«–åƒ¹</div>
                            <div class="value" id="sumAvgTheoretical">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡æœ€ä½å¾—æ¨™</div>
                            <div class="value" id="sumAvgMinBid">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡æœ€ä½æº¢åƒ¹</div>
                            <div class="value" id="sumAvgMinPremium">0%</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡æœ€é«˜å¾—æ¨™</div>
                            <div class="value" id="sumAvgMaxBid">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡æœ€é«˜æº¢åƒ¹</div>
                            <div class="value" id="sumAvgMaxPremium">0%</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #ff9800;">
                            <div class="label">å¹³å‡å¾—æ¨™åƒ¹</div>
                            <div class="value highlight" id="sumAvgBid">0</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #ff9800;">
                            <div class="label">å¹³å‡å¾—æ¨™æº¢åƒ¹</div>
                            <div class="value highlight" id="sumAvgPremium">0%</div>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 style="color: #4caf50; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #4caf50; padding-bottom: 5px; display: inline-block;">ğŸ¯ æ›ç‰Œè¡¨ç¾çµ±è¨ˆ</h4>
                    <div class="summary-grid">
                        <div class="summary-item" style="border-left: 3px solid #4caf50;">
                            <div class="label">å¹³å‡æ›ç‰Œæœ€é«˜</div>
                            <div class="value highlight" id="sumAvgListHigh">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">å¹³å‡æ›ç‰Œæœ€ä½</div>
                            <div class="value" id="sumAvgListLow">0</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #4caf50;">
                            <div class="label">å¹³å‡æ›ç‰Œæ¼²å¹…</div>
                            <div class="value highlight" id="sumAvgListGain">0%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p style="font-weight: 500;">è³‡æ–™æœŸé–“ï¼š2025å¹´5æœˆ - 8æœˆ | è³‡æ–™ä¾†æºï¼šè­‰åˆ¸æ«ƒæª¯è²·è³£ä¸­å¿ƒ</p>
            <p style="margin-top: 8px; color: #f44336; font-weight: 500;">âš ï¸ æœ¬è¡¨åƒ…ä¾›åƒè€ƒï¼ŒæŠ•è³‡æ±ºç­–è«‹è‡ªè¡Œè©•ä¼°é¢¨éšª</p>
            
            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #dee2e6;">
                <p style="font-weight: 600; color: #495057; margin-bottom: 12px; font-size: 1rem;">
                    ğŸ“š Rexå¤§å”çš„168å°è‚¡æŠ•è³‡æ•™å®¤
                </p>
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 12px;">
                    <a href="https://vocus.cc/salon/655c9dbcfd897800019d5bb4" target="_blank" 
                       style="color: white; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
                              padding: 8px 20px; border-radius: 20px; text-decoration: none; 
                              font-weight: 600; transition: all 0.3s; display: inline-flex; 
                              align-items: center; gap: 6px; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);"
                       onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.4)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'">
                        <span>ğŸ“</span>
                        <span>æ–¹æ ¼å­éƒ¨è½æ ¼</span>
                    </a>
                    <a href="https://www.youtube.com/@rexdashu168" target="_blank"
                       style="color: white; background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%); 
                              padding: 8px 20px; border-radius: 20px; text-decoration: none; 
                              font-weight: 600; transition: all 0.3s; display: inline-flex; 
                              align-items: center; gap: 6px; box-shadow: 0 2px 8px rgba(255, 0, 0, 0.3);"
                       onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(255, 0, 0, 0.4)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(255, 0, 0, 0.3)'">
                        <span>ğŸ¬</span>
                        <span>YouTubeé »é“</span>
                    </a>
                </div>
                <p style="font-size: 0.85rem; color: #6c757d;">æ›´å¤šæŠ•è³‡è§€å¿µèˆ‡å¯è½‰å‚µåˆ†æï¼Œæ­¡è¿è¨‚é–±å­¸ç¿’</p>
            </div>
            
            <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-bottom: 8px;">
                    <div style="font-size: 0.9rem; color: #6c757d; display: flex; align-items: center; gap: 6px;">
                        <span>ğŸ‘ï¸</span>
                        <span>ä»Šæ—¥ç€è¦½ï¼š</span>
                        <strong style="color: #667eea; font-size: 1.1rem;" id="todayViews">0</strong>
                    </div>
                    <div style="font-size: 0.9rem; color: #6c757d; display: flex; align-items: center; gap: 6px;">
                        <span>ğŸ“Š</span>
                        <span>ç´¯ç©ç€è¦½ï¼š</span>
                        <strong style="color: #667eea; font-size: 1.1rem;" id="totalViews">0</strong>
                    </div>
                </div>
                <p style="font-size: 0.75rem; opacity: 0.7;">ç€è¦½é‡çµ±è¨ˆæ¡ç”¨æœ¬åœ°å„²å­˜ï¼Œåƒ…è¨˜éŒ„æ‚¨çš„ç€è¦½å™¨è¨ªå•æ¬¡æ•¸</p>
            </div>
        </div>
    </div>

    <script>
        // é¡¯ç¤ºç•¶å‰æ—¥æœŸ
        function displayCurrentDate() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            };
            const dateString = now.toLocaleDateString('zh-TW', options);
            document.getElementById('currentDate').textContent = dateString;
        }

        // ç€è¦½é‡è¿½è¹¤ç³»çµ±
        function initializeViewCounter() {
            const today = new Date().toLocaleDateString('zh-TW');
            
            // å–å¾— localStorage ä¸­çš„è³‡æ–™
            let viewData = JSON.parse(localStorage.getItem('cbAuctionViews') || '{}');
            
            // åˆå§‹åŒ–è³‡æ–™çµæ§‹
            if (!viewData.total) {
                viewData.total = 0;
            }
            if (!viewData.daily) {
                viewData.daily = {};
            }
            
            // å¢åŠ ç¸½ç€è¦½é‡
            viewData.total += 1;
            
            // å¢åŠ ä»Šæ—¥ç€è¦½é‡
            if (!viewData.daily[today]) {
                viewData.daily[today] = 0;
            }
            viewData.daily[today] += 1;
            
            // æ¸…ç†30å¤©å‰çš„è³‡æ–™ï¼ˆé¿å… localStorage éå¤§ï¼‰
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            Object.keys(viewData.daily).forEach(date => {
                const dateObj = new Date(date);
                if (dateObj < thirtyDaysAgo) {
                    delete viewData.daily[date];
                }
            });
            
            // å„²å­˜å› localStorage
            localStorage.setItem('cbAuctionViews', JSON.stringify(viewData));
            
            // æ›´æ–°é¡¯ç¤º
            updateViewDisplay(viewData.daily[today], viewData.total);
        }

        // æ›´æ–°ç€è¦½é‡é¡¯ç¤º
        function updateViewDisplay(todayCount, totalCount) {
            // åŠ å…¥å‹•ç•«æ•ˆæœ
            const todayElement = document.getElementById('todayViews');
            const totalElement = document.getElementById('totalViews');
            
            animateNumber(todayElement, todayCount);
            animateNumber(totalElement, totalCount);
        }

        // æ•¸å­—å‹•ç•«æ•ˆæœ
        function animateNumber(element, targetNumber) {
            const duration = 1000; // 1ç§’
            const startNumber = 0;
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                const currentNumber = Math.floor(progress * (targetNumber - startNumber) + startNumber);
                element.textContent = currentNumber.toLocaleString();
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }

        // å®Œæ•´è³‡æ–™
        const auctionData = [
            {no: 262, date: '2025/5/19', stockCode: '6117', cbCode: '61172', name: 'è¿å»£äºŒ', capital: 9.19, scale: '5.0å„„', period: '3å¹´', secured: 'No', rating: 7, volume: 4250, floor: 100.0, cutoffDate: '2025/5/15', cutoffPrice: 92.00, convPrice: 79.30, pricePremium: '102.00%', theoretical: 116.02, minBid: 108.50, minPremium: -6.5, maxBid: 120.00, maxPremium: 3.4, avgBid: 110.73, avgPremium: -4.6, listHigh: 129.00, listLow: 109.80},
            {no: 263, date: '2025/5/20', stockCode: '1472', cbCode: '14722', name: 'ä¸‰æ´‹å¯¦æ¥­äºŒ', capital: 5.25, scale: '3.0å„„', period: '3å¹´', secured: 'Yes', rating: 7, volume: 2550, floor: 100.0, cutoffDate: '2025/5/16', cutoffPrice: 107.00, convPrice: 102.00, pricePremium: '102.48%', theoretical: 104.90, minBid: 108.36, minPremium: 3.3, maxBid: 115.40, maxPremium: 10.0, avgBid: 110.71, avgPremium: 5.5, listHigh: 110.30, listLow: 104.00},
            {no: 264, date: '2025/5/28', stockCode: '4555', cbCode: '45554', name: 'æ°£ç«‹å››', capital: 7.00, scale: '5.0å„„', period: '3å¹´', secured: 'Yes', rating: 6, volume: 4250, floor: 102.0, cutoffDate: '2025/5/26', cutoffPrice: 41.20, convPrice: 44.00, pricePremium: '104.76%', theoretical: 93.64, minBid: 102.00, minPremium: 8.9, maxBid: 107.11, maxPremium: 14.4, avgBid: 103.28, avgPremium: 10.3, listHigh: 119.50, listLow: 100.00},
            {no: 265, date: '2025/6/4', stockCode: '3653', cbCode: '36535', name: 'å¥ç­–äº”', capital: 14.29, scale: '20.0å„„', period: '5å¹´', secured: 'No', rating: 3, volume: 17012, floor: 105.0, cutoffDate: '2025/6/2', cutoffPrice: 1320.00, convPrice: 1320.90, pricePremium: '102.00%', theoretical: 99.93, minBid: 106.61, minPremium: 6.7, maxBid: 200.00, maxPremium: 100.1, avgBid: 108.37, avgPremium: 8.4, listHigh: 159.00, listLow: 115.00},
            {no: 266, date: '2025/6/5', stockCode: '3617', cbCode: '36173', name: 'ç¢©å¤©ä¸‰', capital: 9.42, scale: '15.0å„„', period: '3å¹´', secured: 'No', rating: 4, volume: 12750, floor: 100.0, cutoffDate: '2025/6/3', cutoffPrice: 253.00, convPrice: 305.00, pricePremium: '114.66%', theoretical: 82.95, minBid: 100.00, minPremium: 20.6, maxBid: 270.00, maxPremium: 225.5, avgBid: 100.79, avgPremium: 21.5, listHigh: 111.00, listLow: 99.85},
            {no: 267, date: '2025/6/6', stockCode: '2351', cbCode: '23511', name: 'é †å¾·ä¸€', capital: 18.21, scale: '12.0å„„', period: '3å¹´', secured: 'No', rating: 5, volume: 10200, floor: 100.0, cutoffDate: '2025/6/4', cutoffPrice: 71.30, convPrice: 75.00, pricePremium: '104.90%', theoretical: 95.07, minBid: 100.14, minPremium: 5.3, maxBid: 107.51, maxPremium: 13.1, avgBid: 102.18, avgPremium: 7.5, listHigh: 132.00, listLow: 102.20},
            {no: 268, date: '2025/6/11', stockCode: '1466', cbCode: '14664', name: 'èšéš†å››', capital: 11.12, scale: '4.0å„„', period: '3å¹´', secured: 'Yes', rating: 7, volume: 3400, floor: 100.0, cutoffDate: '2025/6/9', cutoffPrice: 16.80, convPrice: 18.80, pricePremium: '104.00%', theoretical: 89.36, minBid: 101.00, minPremium: 13.0, maxBid: 108.00, maxPremium: 20.9, avgBid: 103.11, avgPremium: 15.4, listHigh: 107.80, listLow: 103.00},
            {no: 269, date: '2025/6/17', stockCode: '6538', cbCode: '65381', name: 'å€‰å’Œä¸€', capital: 3.81, scale: '3.0å„„', period: '5å¹´', secured: 'No', rating: 5, volume: 2550, floor: 101.0, cutoffDate: '2025/6/13', cutoffPrice: 108.00, convPrice: 112.00, pricePremium: '102.30%', theoretical: 96.43, minBid: 101.30, minPremium: 5.1, maxBid: 106.22, maxPremium: 10.2, avgBid: 102.54, avgPremium: 6.3, listHigh: 101.00, listLow: 92.50},
            {no: 270, date: '2025/6/19', stockCode: '2247', cbCode: '22472', name: 'æ±å¾·äºŒ', capital: 8.07, scale: '10.0å„„', period: '3å¹´', secured: 'No', rating: 4, volume: 8500, floor: 101.0, cutoffDate: '2025/6/17', cutoffPrice: 289.00, convPrice: 297.80, pricePremium: '102.50%', theoretical: 97.04, minBid: 101.55, minPremium: 4.6, maxBid: 200.00, maxPremium: 106.1, avgBid: 102.37, avgPremium: 5.5, listHigh: 119.95, listLow: 102.00},
            {no: 271, date: '2025/6/19', stockCode: '2530', cbCode: '25304', name: 'è¯å»ºå››', capital: 84.00, scale: '10.0å„„', period: '3å¹´', secured: 'No', rating: 7, volume: 7180, floor: 100.0, cutoffDate: '2025/6/17', cutoffPrice: 32.45, convPrice: 32.50, pricePremium: '102.30%', theoretical: 99.85, minBid: 100.00, minPremium: 0.2, maxBid: 110.00, maxPremium: 10.2, avgBid: 100.37, avgPremium: 0.5, listHigh: 99.60, listLow: 92.40},
            {no: 272, date: '2025/7/17', stockCode: '6469', cbCode: '64693', name: 'å¤§æ¨¹ä¸‰', capital: 14.97, scale: '10.0å„„', period: '3å¹´', secured: 'No', rating: 4, volume: 8650, floor: 100.0, cutoffDate: '2025/7/15', cutoffPrice: 143.50, convPrice: 149.74, pricePremium: '102.00%', theoretical: 95.83, minBid: 101.51, minPremium: 5.9, maxBid: 109.00, maxPremium: 13.7, avgBid: 102.20, avgPremium: 6.6, listHigh: 118.50, listLow: 108.60},
            {no: 273, date: '2025/7/23', stockCode: '8411', cbCode: '84113', name: 'ç¦è²ä¸‰KY', capital: 21.84, scale: '12.0å„„', period: '5å¹´', secured: 'Yes', rating: 6, volume: 10200, floor: 100.0, cutoffDate: '2025/7/21', cutoffPrice: 13.20, convPrice: 13.40, pricePremium: '103.00%', theoretical: 98.51, minBid: 100.00, minPremium: 1.5, maxBid: 103.60, maxPremium: 5.2, avgBid: 100.49, avgPremium: 2.0, listHigh: 102.30, listLow: 99.30},
            {no: 274, date: '2025/7/24', stockCode: '6982', cbCode: '69822', name: 'å¤§äº•æ³µæµ¦äºŒ', capital: 4.03, scale: '2.0å„„', period: '3å¹´', secured: 'No', rating: 7, volume: 1709, floor: 100.0, cutoffDate: '2025/7/22', cutoffPrice: 62.50, convPrice: 61.80, pricePremium: '102.10%', theoretical: 101.13, minBid: 100.00, minPremium: -1.1, maxBid: 109.91, maxPremium: 8.7, avgBid: 101.16, avgPremium: 0.0, listHigh: 120.00, listLow: 102.05},
            {no: 275, date: '2025/7/24', stockCode: '6843', cbCode: '68431', name: 'é€²å…¸ä¸€', capital: 3.33, scale: '3.0å„„', period: '3å¹´', secured: 'No', rating: 6, volume: 2700, floor: 101.0, cutoffDate: '2025/7/22', cutoffPrice: 59.80, convPrice: 61.40, pricePremium: '102.56%', theoretical: 97.39, minBid: 101.01, minPremium: 3.7, maxBid: 105.91, maxPremium: 8.7, avgBid: 101.83, avgPremium: 4.6, listHigh: 114.30, listLow: 102.00},
            {no: 276, date: '2025/7/25', stockCode: '3131', cbCode: '31312', name: 'å¼˜å¡‘äºŒ', capital: 2.92, scale: '10.0å„„', period: '5å¹´', secured: 'No', rating: 5, volume: 8500, floor: 103.0, cutoffDate: '2025/7/23', cutoffPrice: 1565.00, convPrice: 1649.20, pricePremium: '102.01%', theoretical: 94.89, minBid: 109.14, minPremium: 15.0, maxBid: 120.00, maxPremium: 26.5, avgBid: 110.50, avgPremium: 16.4, listHigh: 124.00, listLow: 110.30},
            {no: 277, date: '2025/7/28', stockCode: '3167', cbCode: '31672', name: 'å¤§é‡äºŒ', capital: 8.84, scale: '5.0å„„', period: '3å¹´', secured: 'No', rating: 6, volume: 4661, floor: 100.0, cutoffDate: '2025/7/24', cutoffPrice: 168.00, convPrice: 170.00, pricePremium: '108.40%', theoretical: 98.82, minBid: 107.39, minPremium: 8.7, maxBid: 116.88, maxPremium: 18.3, avgBid: 109.09, avgPremium: 10.4, listHigh: 140.25, listLow: 113.00},
            {no: 278, date: '2025/7/28', stockCode: '2641', cbCode: '26418', name: 'æ­£å¾·å…«', capital: 32.49, scale: '7.8å„„', period: '5å¹´', secured: 'No', rating: 6, volume: 7020, floor: 100.5, cutoffDate: '2025/7/24', cutoffPrice: 19.50, convPrice: 19.30, pricePremium: '102.12%', theoretical: 101.04, minBid: 100.50, minPremium: -0.5, maxBid: 109.30, maxPremium: 8.2, avgBid: 101.30, avgPremium: 0.3, listHigh: 110.60, listLow: 100.00},
            {no: 279, date: '2025/8/6', stockCode: '7556', cbCode: '75562', name: 'æ„å¾·å£«äºŒ', capital: 2.73, scale: '2.0å„„', period: '3å¹´', secured: 'No', rating: 6, volume: 1800, floor: 100.0, cutoffDate: '2025/8/4', cutoffPrice: 174.00, convPrice: 178.50, pricePremium: '102.00%', theoretical: 97.48, minBid: 107.50, minPremium: 10.3, maxBid: 117.00, maxPremium: 20.0, avgBid: 109.25, avgPremium: 12.1, listHigh: 124.85, listLow: 118.00},
            {no: 280, date: '2025/8/6', stockCode: '4581', cbCode: '45811', name: 'å…‰éš†ç²¾å¯†ä¸€KY', capital: 3.39, scale: '5.0å„„', period: '3å¹´', secured: 'No', rating: 5, volume: 4380, floor: 100.5, cutoffDate: '2025/8/4', cutoffPrice: 52.70, convPrice: 56.70, pricePremium: '102.50%', theoretical: 92.95, minBid: 100.50, minPremium: 8.1, maxBid: 107.92, maxPremium: 16.1, avgBid: 100.94, avgPremium: 8.6, listHigh: 107.05, listLow: 99.95},
            {no: 281, date: '2025/8/19', stockCode: '4558', cbCode: '45581', name: 'å¯¶ç·¯ä¸€', capital: 5.00, scale: '3.0å„„', period: '3å¹´', secured: 'Yes', rating: 8, volume: 2624, floor: 100.0, cutoffDate: '2025/8/15', cutoffPrice: 27.50, convPrice: 29.80, pricePremium: '102.58%', theoretical: 92.28, minBid: 100.10, minPremium: 8.5, maxBid: 107.00, maxPremium: 15.9, avgBid: 101.17, avgPremium: 9.6, listHigh: 103.00, listLow: 101.00},
            {no: 282, date: '2025/8/19', stockCode: '2743', cbCode: '27431', name: 'å±±å¯Œä¸€', capital: 3.60, scale: '3.0å„„', period: '3å¹´', secured: 'No', rating: 4, volume: 2640, floor: 102.0, cutoffDate: '2025/8/15', cutoffPrice: 106.00, convPrice: 135.00, pricePremium: '106.30%', theoretical: 78.52, minBid: 102.00, minPremium: 29.9, maxBid: 110.00, maxPremium: 40.1, avgBid: 102.31, avgPremium: 30.3, listHigh: 103.40, listLow: 102.00}
        ];

        let filteredData = [...auctionData];

        // å¿«é€ŸæœŸé–“é¸æ“‡
        function setQuickPeriod() {
            const quickPeriod = document.getElementById('quickPeriod').value;
            const today = new Date('2025-08-31'); // ä½¿ç”¨è³‡æ–™æœ€å¾Œæ—¥æœŸä½œç‚ºåŸºæº–
            let startDate, endDate;

            switch(quickPeriod) {
                case 'all':
                    startDate = '2025-05-01';
                    endDate = '2025-08-31';
                    break;
                case 'month1':
                    startDate = '2025-08-01';
                    endDate = '2025-08-31';
                    break;
                case 'month2':
                    startDate = '2025-07-01';
                    endDate = '2025-08-31';
                    break;
                case 'month3':
                    startDate = '2025-06-01';
                    endDate = '2025-08-31';
                    break;
                case 'may':
                    startDate = '2025-05-01';
                    endDate = '2025-05-31';
                    break;
                case 'june':
                    startDate = '2025-06-01';
                    endDate = '2025-06-30';
                    break;
                case 'july':
                    startDate = '2025-07-01';
                    endDate = '2025-07-31';
                    break;
                case 'august':
                    startDate = '2025-08-01';
                    endDate = '2025-08-31';
                    break;
                case 'q2':
                    startDate = '2025-05-01';
                    endDate = '2025-06-30';
                    break;
                case 'q3':
                    startDate = '2025-07-01';
                    endDate = '2025-08-31';
                    break;
                default:
                    return;
            }

            document.getElementById('startDate').value = startDate;
            document.getElementById('endDate').value = endDate;
        }

        // æ—¥æœŸç¯„åœç¯©é¸
        function filterByDateRange(data, startDate, endDate) {
            const start = new Date(startDate);
            const end = new Date(endDate);
            
            return data.filter(item => {
                const itemDate = new Date(item.date);
                return itemDate >= start && itemDate <= end;
            });
        }

        // å€é–“ç¯©é¸è¼”åŠ©å‡½æ•¸
        function isInRange(value, rangeStr) {
            if (!rangeStr) return true;
            
            const [min, max] = rangeStr.split('-').map(Number);
            return value >= min && value < max;
        }

        // ç™¼è¡Œè¦æ¨¡ç¯©é¸
        function filterByScale(item, scaleFilter) {
            if (!scaleFilter) return true;
            
            const scale = parseFloat(item.scale.replace('å„„', ''));
            return isInRange(scale, scaleFilter);
        }

        // è‚¡æœ¬ç¯©é¸
        function filterByCapital(item, capitalFilter) {
            if (!capitalFilter) return true;
            
            return isInRange(item.capital, capitalFilter);
        }

        // ä¿¡è©•ç¯©é¸
        function filterByRating(item, ratingFilter) {
            if (!ratingFilter) return true;
            
            return item.rating === parseInt(ratingFilter);
        }

        // è¨‚åƒ¹æº¢åƒ¹ç‡ç¯©é¸
        function filterByPricePremium(item, pricePremiumFilter) {
            if (!pricePremiumFilter) return true;
            
            // å°‡ "102.00%" è½‰æ›ç‚ºæ•¸å­— 102
            const premiumValue = parseFloat(item.pricePremium.replace('%', ''));
            return isInRange(premiumValue, pricePremiumFilter);
        }

        // æ›ç‰Œæœ€é«˜åƒ¹ç¯©é¸
        function filterByListHigh(item, listHighFilter) {
            if (!listHighFilter) return true;
            
            return isInRange(item.listHigh, listHighFilter);
        }

        // åˆå§‹åŒ–é¡¯ç¤º
        function init() {
            displayCurrentDate();
            initializeViewCounter();
            displayData(filteredData);
            updateStats(filteredData);
            updateSummary(filteredData);
        }

        // é¡¯ç¤ºè³‡æ–™
        function displayData(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            data.forEach(item => {
                const row = document.createElement('tr');
                const minPremiumClass = item.minPremium >= 0 ? 'positive' : 'negative';
                const maxPremiumClass = item.maxPremium >= 0 ? 'positive' : 'negative';
                const avgPremiumClass = item.avgPremium >= 0 ? 'positive' : 'negative';

                row.innerHTML = `
                    <td>${item.no}</td>
                    <td>${item.date}</td>
                    <td class="cb-code">${item.stockCode}</td>
                    <td class="cb-code">${item.cbCode}</td>
                    <td style="text-align: left; white-space: nowrap;">${item.name}</td>
                    <td>${item.capital}</td>
                    <td>${item.scale}</td>
                    <td>${item.period}</td>
                    <td><span class="badge ${item.secured === 'Yes' ? 'badge-yes' : 'badge-no'}">${item.secured === 'Yes' ? 'æœ‰' : 'ç„¡'}</span></td>
                    <td>${item.rating}</td>
                    <td>${item.volume.toLocaleString()}</td>
                    <td>${item.floor.toFixed(1)}</td>
                    <td>${item.cutoffDate}</td>
                    <td>${item.cutoffPrice.toFixed(2)}</td>
                    <td>${item.convPrice.toFixed(2)}</td>
                    <td>${item.pricePremium}</td>
                    <td>${item.theoretical.toFixed(2)}</td>
                    <td>${item.minBid.toFixed(2)}</td>
                    <td class="${minPremiumClass}">${item.minPremium.toFixed(1)}%</td>
                    <td>${item.maxBid.toFixed(2)}</td>
                    <td class="${maxPremiumClass}">${item.maxPremium.toFixed(1)}%</td>
                    <td>${item.avgBid.toFixed(2)}</td>
                    <td class="${avgPremiumClass}">${item.avgPremium.toFixed(1)}%</td>
                    <td>${item.listHigh.toFixed(2)}</td>
                    <td>${item.listLow.toFixed(2)}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // æ›´æ–°çµ±è¨ˆ
        function updateStats(data) {
            if (data.length === 0) {
                // å¦‚æœæ²’æœ‰è³‡æ–™ï¼Œé¡¯ç¤ºç©ºå€¼
                document.getElementById('periodRange').textContent = 'ç„¡è³‡æ–™';
                document.getElementById('periodDays').textContent = '';
                document.getElementById('totalCount').textContent = '0';
                document.getElementById('totalScale').textContent = '-';
                document.getElementById('avgScale').textContent = '-';
                document.getElementById('avgPremium').textContent = '-';
                document.getElementById('maxPremium').textContent = '-';
                document.getElementById('minPremium').textContent = '-';
                document.getElementById('medianPremium').textContent = '-';
                document.getElementById('securedRatio').textContent = '-';
                document.getElementById('period3Ratio').textContent = '-';
                document.getElementById('avgRating').textContent = '-';
                document.getElementById('avgListGain').textContent = '-';
                return;
            }

            // æŸ¥è©¢æœŸé–“
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const start = new Date(startDate);
            const end = new Date(endDate);
            const daysDiff = Math.ceil((end - start) / (1000 * 60 * 60 * 24)) + 1;
            
            document.getElementById('periodRange').textContent = 
                `${start.getMonth()+1}/${start.getDate()} - ${end.getMonth()+1}/${end.getDate()}`;
            document.getElementById('periodDays').textContent = `${daysDiff}å¤©`;

            // ç¸½æª”æ•¸
            document.getElementById('totalCount').textContent = data.length;
            
            // ç¸½ç™¼è¡Œè¦æ¨¡å’Œå¹³å‡è¦æ¨¡
            const totalScale = data.reduce((sum, item) => {
                const scale = parseFloat(item.scale.replace('å„„', ''));
                return sum + scale;
            }, 0);
            document.getElementById('totalScale').textContent = totalScale.toFixed(1);
            document.getElementById('avgScale').textContent = (totalScale / data.length).toFixed(1);

            // å¹³å‡å¾—æ¨™æº¢åƒ¹
            const avgPremium = data.reduce((sum, item) => sum + item.avgPremium, 0) / data.length;
            document.getElementById('avgPremium').textContent = avgPremium.toFixed(1) + '%';

            // æœ€é«˜å¾—æ¨™æº¢åƒ¹
            const maxPremiumItem = data.reduce((max, item) => item.maxPremium > max.maxPremium ? item : max);
            document.getElementById('maxPremium').textContent = maxPremiumItem.maxPremium.toFixed(1) + '%';
            document.getElementById('maxPremiumName').textContent = maxPremiumItem.name;

            // æœ€ä½å¾—æ¨™æº¢åƒ¹
            const minPremiumItem = data.reduce((min, item) => item.minPremium < min.minPremium ? item : min);
            document.getElementById('minPremium').textContent = minPremiumItem.minPremium.toFixed(1) + '%';
            document.getElementById('minPremiumName').textContent = minPremiumItem.name;

            // ä¸­ä½æ•¸æº¢åƒ¹
            const sortedPremiums = data.map(item => item.avgPremium).sort((a, b) => a - b);
            const medianIndex = Math.floor(sortedPremiums.length / 2);
            const medianPremium = sortedPremiums.length % 2 === 0 
                ? (sortedPremiums[medianIndex - 1] + sortedPremiums[medianIndex]) / 2
                : sortedPremiums[medianIndex];
            document.getElementById('medianPremium').textContent = medianPremium.toFixed(1) + '%';

            // æœ‰æ“”ä¿æ¯”ä¾‹
            const securedCount = data.filter(item => item.secured === 'Yes').length;
            const securedRatio = (securedCount / data.length * 100).toFixed(1);
            document.getElementById('securedRatio').textContent = securedRatio + '%';
            document.getElementById('securedCount').textContent = `${securedCount}æª”`;

            // 3å¹´æœŸæ¯”ä¾‹
            const period3Count = data.filter(item => item.period === '3å¹´').length;
            const period3Ratio = (period3Count / data.length * 100).toFixed(1);
            document.getElementById('period3Ratio').textContent = period3Ratio + '%';
            document.getElementById('period3Count').textContent = `${period3Count}æª”`;

            // å¹³å‡ä¿¡è©•ç­‰ç´š
            const avgRating = data.reduce((sum, item) => sum + item.rating, 0) / data.length;
            document.getElementById('avgRating').textContent = avgRating.toFixed(1);

            // æ›ç‰Œå¾Œå¹³å‡æ¼²å¹…
            const avgListGain = data.reduce((sum, item) => {
                const gain = ((item.listHigh - item.avgBid) / item.avgBid * 100);
                return sum + gain;
            }, 0) / data.length;
            document.getElementById('avgListGain').textContent = avgListGain.toFixed(1) + '%';
        }

        // æŸ¥è©¢åŠŸèƒ½
        function searchData() {
            const stockCode = document.getElementById('stockCode').value.trim();
            const cbCode = document.getElementById('cbCode').value.trim();
            const companyName = document.getElementById('companyName').value.trim();
            const securityFilter = document.getElementById('securityFilter').value;
            const periodFilter = document.getElementById('periodFilter').value;
            const scaleFilter = document.getElementById('scaleFilter').value;
            const ratingFilter = document.getElementById('ratingFilter').value;
            const capitalFilter = document.getElementById('capitalFilter').value;
            const pricePremiumFilter = document.getElementById('pricePremiumFilter').value;
            const listHighFilter = document.getElementById('listHighFilter').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            // å…ˆä¾æ—¥æœŸç¯„åœç¯©é¸
            filteredData = filterByDateRange(auctionData, startDate, endDate);

            // å†ä¾å…¶ä»–æ¢ä»¶ç¯©é¸
            filteredData = filteredData.filter(item => {
                const matchStock = !stockCode || item.stockCode.includes(stockCode);
                const matchCB = !cbCode || item.cbCode.includes(cbCode);
                const matchName = !companyName || item.name.includes(companyName);
                const matchSecurity = !securityFilter || item.secured === securityFilter;
                const matchPeriod = !periodFilter || item.period === periodFilter;
                const matchScale = filterByScale(item, scaleFilter);
                const matchRating = filterByRating(item, ratingFilter);
                const matchCapital = filterByCapital(item, capitalFilter);
                const matchPricePremium = filterByPricePremium(item, pricePremiumFilter);
                const matchListHigh = filterByListHigh(item, listHighFilter);

                return matchStock && matchCB && matchName && matchSecurity && 
                       matchPeriod && matchScale && matchRating && matchCapital &&
                       matchPricePremium && matchListHigh;
            });

            displayData(filteredData);
            updateStats(filteredData);
            updateSummary(filteredData);

            // é¡¯ç¤ºç¯©é¸çµæœæç¤º
            if (filteredData.length === 0) {
                alert('æŸ¥ç„¡ç¬¦åˆæ¢ä»¶çš„è³‡æ–™ï¼Œè«‹èª¿æ•´ç¯©é¸æ¢ä»¶');
            }

            // é‡ç½®å¿«é€Ÿé¸æ“‡ä¸‹æ‹‰é¸å–®
            document.getElementById('quickPeriod').value = '';
        }

        // æ›´æ–°çµ±è¨ˆåŒ¯ç¸½
        function updateSummary(data) {
            const summarySection = document.getElementById('summarySection');
            
            if (data.length === 0) {
                summarySection.style.display = 'none';
                return;
            }

            summarySection.style.display = 'block';

            // ç¯©é¸æª”æ•¸
            document.getElementById('sumCount').textContent = data.length;

            // å¹³å‡è‚¡æœ¬
            const avgCapital = data.reduce((sum, item) => sum + item.capital, 0) / data.length;
            document.getElementById('sumAvgCapital').textContent = avgCapital.toFixed(2) + 'å„„';

            // å¹³å‡ç™¼è¡Œè¦æ¨¡
            const avgScale = data.reduce((sum, item) => {
                const scale = parseFloat(item.scale.replace('å„„', ''));
                return sum + scale;
            }, 0) / data.length;
            document.getElementById('sumAvgScale').textContent = avgScale.toFixed(2) + 'å„„';

            // å¹³å‡ä¿¡è©•
            const avgRating = data.reduce((sum, item) => sum + item.rating, 0) / data.length;
            document.getElementById('sumAvgRating').textContent = avgRating.toFixed(2) + 'åˆ†';

            // å¹³å‡åº•æ¨™åƒ¹
            const avgFloor = data.reduce((sum, item) => sum + item.floor, 0) / data.length;
            document.getElementById('sumAvgFloor').textContent = avgFloor.toFixed(2);

            // å¹³å‡ç†è«–åƒ¹
            const avgTheoretical = data.reduce((sum, item) => sum + item.theoretical, 0) / data.length;
            document.getElementById('sumAvgTheoretical').textContent = avgTheoretical.toFixed(2);

            // å¹³å‡æœ€ä½å¾—æ¨™
            const avgMinBid = data.reduce((sum, item) => sum + item.minBid, 0) / data.length;
            document.getElementById('sumAvgMinBid').textContent = avgMinBid.toFixed(2);

            // å¹³å‡æœ€ä½æº¢åƒ¹
            const avgMinPremium = data.reduce((sum, item) => sum + item.minPremium, 0) / data.length;
            document.getElementById('sumAvgMinPremium').textContent = avgMinPremium.toFixed(2) + '%';

            // å¹³å‡æœ€é«˜å¾—æ¨™
            const avgMaxBid = data.reduce((sum, item) => sum + item.maxBid, 0) / data.length;
            document.getElementById('sumAvgMaxBid').textContent = avgMaxBid.toFixed(2);

            // å¹³å‡æœ€é«˜æº¢åƒ¹
            const avgMaxPremium = data.reduce((sum, item) => sum + item.maxPremium, 0) / data.length;
            document.getElementById('sumAvgMaxPremium').textContent = avgMaxPremium.toFixed(2) + '%';

            // å¹³å‡å¾—æ¨™åƒ¹
            const avgBid = data.reduce((sum, item) => sum + item.avgBid, 0) / data.length;
            document.getElementById('sumAvgBid').textContent = avgBid.toFixed(2);

            // å¹³å‡å¾—æ¨™æº¢åƒ¹
            const avgPremium = data.reduce((sum, item) => sum + item.avgPremium, 0) / data.length;
            document.getElementById('sumAvgPremium').textContent = avgPremium.toFixed(2) + '%';

            // å¹³å‡æ›ç‰Œæœ€é«˜
            const avgListHigh = data.reduce((sum, item) => sum + item.listHigh, 0) / data.length;
            document.getElementById('sumAvgListHigh').textContent = avgListHigh.toFixed(2);

            // å¹³å‡æ›ç‰Œæœ€ä½
            const avgListLow = data.reduce((sum, item) => sum + item.listLow, 0) / data.length;
            document.getElementById('sumAvgListLow').textContent = avgListLow.toFixed(2);

            // å¹³å‡æ›ç‰Œæ¼²å¹…
            const avgListGain = data.reduce((sum, item) => {
                const gain = ((item.listHigh - item.avgBid) / item.avgBid * 100);
                return sum + gain;
            }, 0) / data.length;
            document.getElementById('sumAvgListGain').textContent = avgListGain.toFixed(2) + '%';

            // æœ‰æ“”ä¿æ¯”ä¾‹
            const securedCount = data.filter(item => item.secured === 'Yes').length;
            const securedRatio = (securedCount / data.length * 100);
            document.getElementById('sumSecuredRatio').textContent = securedRatio.toFixed(1) + '%';
        }

        // é‡ç½®åŠŸèƒ½
        function resetSearch() {
            document.getElementById('stockCode').value = '';
            document.getElementById('cbCode').value = '';
            document.getElementById('companyName').value = '';
            document.getElementById('securityFilter').value = '';
            document.getElementById('periodFilter').value = '';
            document.getElementById('scaleFilter').value = '';
            document.getElementById('ratingFilter').value = '';
            document.getElementById('capitalFilter').value = '';
            document.getElementById('pricePremiumFilter').value = '';
            document.getElementById('listHighFilter').value = '';
            document.getElementById('startDate').value = '2025-05-01';
            document.getElementById('endDate').value = '2025-08-31';
            document.getElementById('quickPeriod').value = '';

            filteredData = [...auctionData];
            displayData(filteredData);
            updateStats(filteredData);
            updateSummary(filteredData);
        }

        // åŒ¯å‡ºåŠŸèƒ½
        function exportToExcel() {
            alert('åŒ¯å‡ºåŠŸèƒ½é–‹ç™¼ä¸­\n\nç›®å‰é¡¯ç¤º ' + filteredData.length + ' ç­†è³‡æ–™');
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        window.onload = init;
    </script>
</body>
</html>