<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- SEO Meta Tags -->
    <title>可轉債競拍查詢系統 - 2025年5-8月競拍資料分析 | Rex大叔的168台股投資教室</title>
    <meta name="description" content="提供2025年5-8月可轉債競拍資料查詢與分析，包含得標價格、溢價率、掛牌表現等完整數據，幫助投資人做出更明智的投資決策。">
    <meta name="keywords" content="可轉債,CB,競拍,得標價格,溢價率,台股,投資,Rex大叔,168投資教室">
    <meta name="author" content="Rex大叔的168台股投資教室">
    <meta name="robots" content="index, follow">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="可轉債競拍查詢系統 - 2025年5-8月競拍資料分析">
    <meta property="og:description" content="提供完整的可轉債競拍資料查詢與分析工具，即時查詢得標價格與溢價率。">
    <meta property="og:site_name" content="Rex大叔的168台股投資教室">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="可轉債競拍查詢系統">
    <meta name="twitter:description" content="提供完整的可轉債競拍資料查詢與分析工具">

    <!-- Theme Color -->
    <meta name="theme-color" content="#667eea">

    <!-- Favicon (預備) -->
    <!-- <link rel="icon" type="image/png" href="favicon.png"> -->

    <!-- Preload Critical Resources -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="app.js" as="script">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 主容器 -->
    <main class="container" role="main">
        <!-- 頁首 -->
        <header class="header" role="banner">
            <h1>🎯 可轉債競拍查詢系統</h1>
            <p style="margin-bottom: 15px;">2025年5-8月競拍資料分析 | 即時查詢得標價格與溢價率</p>
            <nav class="header-info" aria-label="外部連結">
                <div class="header-info-item" role="text">
                    <span aria-hidden="true">📅</span>
                    <time id="currentDate">載入中...</time>
                </div>
                <div class="header-info-item" style="background: rgba(255, 255, 255, 0.25); cursor: pointer;"
                     onclick="window.open('https://vocus.cc/salon/655c9dbcfd897800019d5bb4', '_blank')"
                     role="link"
                     tabindex="0"
                     aria-label="前往方格子部落格">
                    <span aria-hidden="true">📝</span>
                    <span style="font-weight: 600;">方格子部落格</span>
                </div>
                <div class="header-info-item" style="background: rgba(255, 255, 255, 0.25); cursor: pointer;"
                     onclick="window.open('https://www.youtube.com/@rexdashu168', '_blank')"
                     role="link"
                     tabindex="0"
                     aria-label="前往YouTube頻道">
                    <span aria-hidden="true">🎬</span>
                    <span style="font-weight: 600;">YouTube頻道</span>
                </div>
            </nav>
            <p style="margin-top: 12px; font-size: 0.85rem; opacity: 0.85;">by Rex大叔的168台股投資教室</p>
        </header>

        <!-- 搜尋區域 -->
        <section class="search-section" aria-label="篩選條件">
            <div class="period-selection">
                <h3>
                    <span aria-hidden="true" style="font-size: 1.3rem;">📅</span>
                    <span>查詢期間設定</span>
                </h3>
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: flex-end;">
                    <div class="control-group">
                        <label for="startDate">起始日期</label>
                        <input type="date" id="startDate" value="2025-05-01" aria-label="起始日期">
                    </div>
                    <div class="control-group">
                        <label for="endDate">結束日期</label>
                        <input type="date" id="endDate" value="2025-08-31" aria-label="結束日期">
                    </div>
                    <div class="control-group">
                        <label for="quickPeriod">快速選擇</label>
                        <select id="quickPeriod" onchange="setQuickPeriod()" aria-label="快速選擇期間">
                            <option value="">自訂期間</option>
                            <option value="all">全部資料</option>
                            <option value="month1">最近1個月</option>
                            <option value="month2">最近2個月</option>
                            <option value="month3">最近3個月</option>
                            <option value="may">5月份</option>
                            <option value="june">6月份</option>
                            <option value="july">7月份</option>
                            <option value="august">8月份</option>
                            <option value="q2">第二季(5-6月)</option>
                            <option value="q3">第三季(7-8月)</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="search-controls">
                <div class="control-group">
                    <label for="stockCode">1. 股票代號</label>
                    <input type="text" id="stockCode" placeholder="例如: 6117" aria-label="股票代號">
                </div>
                <div class="control-group">
                    <label for="cbCode">2. CB代號</label>
                    <input type="text" id="cbCode" placeholder="例如: 61172" aria-label="CB代號">
                </div>
                <div class="control-group">
                    <label for="companyName">3. 公司名稱</label>
                    <input type="text" id="companyName" placeholder="例如: 迎廣" aria-label="公司名稱">
                </div>
                <div class="control-group">
                    <label for="securityFilter">4. 有無擔保</label>
                    <select id="securityFilter" aria-label="有無擔保">
                        <option value="">全部</option>
                        <option value="Yes">有擔保</option>
                        <option value="No">無擔保</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="periodFilter">5. 發行年期</label>
                    <select id="periodFilter" aria-label="發行年期">
                        <option value="">全部</option>
                        <option value="3年">3年</option>
                        <option value="5年">5年</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="scaleFilter">6. 發行規模</label>
                    <select id="scaleFilter" aria-label="發行規模">
                        <option value="">全部</option>
                        <option value="0-3">3億以下</option>
                        <option value="3-6">3-6億</option>
                        <option value="6-10">6-10億</option>
                        <option value="10-15">10-15億</option>
                        <option value="15-20">15-20億</option>
                        <option value="20-999">20億以上</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="ratingFilter">7. 信用評等 (TCRI)</label>
                    <select id="ratingFilter" aria-label="信用評等">
                        <option value="">全部</option>
                        <option value="2">2分</option>
                        <option value="3">3分</option>
                        <option value="4">4分</option>
                        <option value="5">5分</option>
                        <option value="6">6分</option>
                        <option value="7">7分</option>
                        <option value="8">8分</option>
                        <option value="9">9分</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="capitalFilter">8. 股本區間</label>
                    <select id="capitalFilter" aria-label="股本區間">
                        <option value="">全部</option>
                        <option value="0-3">3億以下</option>
                        <option value="3-6">3-6億</option>
                        <option value="6-10">6-10億</option>
                        <option value="10-15">10-15億</option>
                        <option value="15-20">15-20億</option>
                        <option value="20-999">20億以上</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="pricePremiumFilter">9. 訂價溢價率區間</label>
                    <select id="pricePremiumFilter" aria-label="訂價溢價率區間">
                        <option value="">全部</option>
                        <option value="0-105">105%以下</option>
                        <option value="105-110">105-110%</option>
                        <option value="110-120">110-120%</option>
                        <option value="120-999">120%以上</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="listHighFilter">10. 掛牌後最高價表現</label>
                    <select id="listHighFilter" aria-label="掛牌後最高價表現">
                        <option value="">全部</option>
                        <option value="0-100">100以下</option>
                        <option value="100-110">100-110</option>
                        <option value="110-120">110-120</option>
                        <option value="120-130">120-130</option>
                        <option value="130-150">130-150</option>
                        <option value="150-999">150以上</option>
                    </select>
                </div>
            </div>

            <div class="btn-group" role="group" aria-label="操作按鈕">
                <button class="btn btn-primary" onclick="searchData()" aria-label="執行查詢">查詢</button>
                <button class="btn btn-secondary" onclick="resetSearch()" aria-label="重置所有篩選條件">重置</button>
                <button class="btn btn-success" onclick="exportToExcel()" aria-label="匯出資料到Excel">匯出Excel</button>
            </div>
        </section>

        <!-- 統計卡片 -->
        <section class="stats-cards" aria-label="統計資訊">
            <article class="stat-card" style="background: linear-gradient(135deg, #fff5e6 0%, #ffffff 100%); border-left: 4px solid #ff9800;">
                <div class="label">查詢期間</div>
                <div class="value" style="font-size: 1.2rem; color: #ff9800;" id="periodRange">-</div>
                <div class="subvalue" id="periodDays">-</div>
            </article>
            <article class="stat-card" style="background: linear-gradient(135deg, #e3f2fd 0%, #ffffff 100%); border-left: 4px solid #2196f3;">
                <div class="label">競拍檔數</div>
                <div class="value" style="color: #2196f3;" id="totalCount">21</div>
            </article>
            <article class="stat-card">
                <div class="label">總發行規模</div>
                <div class="value" id="totalScale">-</div>
                <div class="subvalue">億元</div>
            </article>
            <article class="stat-card">
                <div class="label">平均發行規模</div>
                <div class="value" id="avgScale">-</div>
                <div class="subvalue">億元/檔</div>
            </article>
            <article class="stat-card" style="background: linear-gradient(135deg, #f3e5f5 0%, #ffffff 100%); border-left: 4px solid #9c27b0;">
                <div class="label">平均得標溢價</div>
                <div class="value" style="color: #9c27b0;" id="avgPremium">10.2%</div>
                <div class="subvalue">理論價差距</div>
            </article>
            <article class="stat-card" style="background: linear-gradient(135deg, #ffebee 0%, #ffffff 100%); border-left: 4px solid #f44336;">
                <div class="label">最高得標溢價</div>
                <div class="value" style="color: #f44336;" id="maxPremium">225.5%</div>
                <div class="subvalue" id="maxPremiumName">碩天三</div>
            </article>
            <article class="stat-card" style="background: linear-gradient(135deg, #e8f5e9 0%, #ffffff 100%); border-left: 4px solid #4caf50;">
                <div class="label">最低得標溢價</div>
                <div class="value" style="color: #4caf50;" id="minPremium">-6.5%</div>
                <div class="subvalue" id="minPremiumName">迎廣二</div>
            </article>
            <article class="stat-card">
                <div class="label">中位數溢價</div>
                <div class="value" id="medianPremium">-</div>
                <div class="subvalue">50%分位數</div>
            </article>
            <article class="stat-card">
                <div class="label">有擔保比例</div>
                <div class="value" id="securedRatio">19.0%</div>
                <div class="subvalue" id="securedCount">4檔</div>
            </article>
            <article class="stat-card">
                <div class="label">3年期比例</div>
                <div class="value" id="period3Ratio">-</div>
                <div class="subvalue" id="period3Count">-</div>
            </article>
            <article class="stat-card">
                <div class="label">平均信評等級</div>
                <div class="value" id="avgRating">-</div>
                <div class="subvalue">TCRI評等</div>
            </article>
            <article class="stat-card" style="background: linear-gradient(135deg, #fff3e0 0%, #ffffff 100%); border-left: 4px solid #ff9800;">
                <div class="label">掛牌後平均漲幅</div>
                <div class="value" style="color: #ff9800;" id="avgListGain">-</div>
                <div class="subvalue">最高價 vs 平均得標</div>
            </article>
        </section>

        <!-- 表格容器 -->
        <section class="table-container" aria-label="競拍資料明細">
            <div style="overflow-x: auto;">
                <table id="dataTable" role="table" aria-label="可轉債競拍資料表格">
                    <thead>
                        <tr>
                            <th scope="col">序號</th>
                            <th scope="col">開標日期</th>
                            <th scope="col">股票<br>代號</th>
                            <th scope="col">CB<br>代號</th>
                            <th scope="col">名稱</th>
                            <th scope="col">股本<br>(億)</th>
                            <th scope="col">發行<br>規模</th>
                            <th scope="col">年期</th>
                            <th scope="col">擔保</th>
                            <th scope="col">信評</th>
                            <th scope="col">競拍<br>張數</th>
                            <th scope="col">底標價</th>
                            <th scope="col">截標日</th>
                            <th scope="col">截標<br>收盤價</th>
                            <th scope="col">轉換價</th>
                            <th scope="col">訂價<br>溢價率</th>
                            <th scope="col">理論價</th>
                            <th scope="col">最低<br>得標</th>
                            <th scope="col">最低<br>溢價</th>
                            <th scope="col">最高<br>得標</th>
                            <th scope="col">最高<br>溢價</th>
                            <th scope="col">平均<br>得標</th>
                            <th scope="col">平均<br>溢價</th>
                            <th scope="col">掛牌後<br>最高價</th>
                            <th scope="col">掛牌後<br>最低價</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- 資料將由 JavaScript 動態載入 -->
                    </tbody>
                </table>
            </div>

            <!-- 統計匯總 -->
            <aside id="summarySection" class="summary-table" style="display: none;" aria-label="篩選結果統計">
                <h3>📊 篩選結果統計匯總</h3>

                <div style="margin-bottom: 20px;">
                    <h4 style="color: #667eea; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #667eea; padding-bottom: 5px; display: inline-block;">📈 基本統計</h4>
                    <div class="summary-grid">
                        <div class="summary-item" style="border-left: 3px solid #667eea;">
                            <div class="label">篩選檔數</div>
                            <div class="value highlight" id="sumCount">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均股本</div>
                            <div class="value" id="sumAvgCapital">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均發行規模</div>
                            <div class="value" id="sumAvgScale">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均信評</div>
                            <div class="value" id="sumAvgRating">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">有擔保比例</div>
                            <div class="value" id="sumSecuredRatio">0%</div>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <h4 style="color: #ff9800; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #ff9800; padding-bottom: 5px; display: inline-block;">💰 競拍價格統計</h4>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <div class="label">平均底標價</div>
                            <div class="value" id="sumAvgFloor">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均理論價</div>
                            <div class="value" id="sumAvgTheoretical">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均最低得標</div>
                            <div class="value" id="sumAvgMinBid">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均最低溢價</div>
                            <div class="value" id="sumAvgMinPremium">0%</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均最高得標</div>
                            <div class="value" id="sumAvgMaxBid">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均最高溢價</div>
                            <div class="value" id="sumAvgMaxPremium">0%</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #ff9800;">
                            <div class="label">平均得標價</div>
                            <div class="value highlight" id="sumAvgBid">0</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #ff9800;">
                            <div class="label">平均得標溢價</div>
                            <div class="value highlight" id="sumAvgPremium">0%</div>
                        </div>
                    </div>
                </div>

                <div>
                    <h4 style="color: #4caf50; font-size: 0.95rem; margin-bottom: 10px; font-weight: 600; border-bottom: 2px solid #4caf50; padding-bottom: 5px; display: inline-block;">🎯 掛牌表現統計</h4>
                    <div class="summary-grid">
                        <div class="summary-item" style="border-left: 3px solid #4caf50;">
                            <div class="label">平均掛牌最高</div>
                            <div class="value highlight" id="sumAvgListHigh">0</div>
                        </div>
                        <div class="summary-item">
                            <div class="label">平均掛牌最低</div>
                            <div class="value" id="sumAvgListLow">0</div>
                        </div>
                        <div class="summary-item" style="border-left: 3px solid #4caf50;">
                            <div class="label">平均掛牌漲幅</div>
                            <div class="value highlight" id="sumAvgListGain">0%</div>
                        </div>
                    </div>
                </div>
            </aside>
        </section>

        <!-- 頁尾 -->
        <footer class="footer" role="contentinfo">
            <p style="font-weight: 500;">資料期間：2025年5月 - 8月 | 資料來源：證券櫃檯買賣中心</p>
            <p style="margin-top: 8px; color: #f44336; font-weight: 500;">⚠️ 本表僅供參考，投資決策請自行評估風險</p>

            <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #dee2e6;">
                <p style="font-weight: 600; color: #495057; margin-bottom: 12px; font-size: 1rem;">
                    📚 Rex大叔的168台股投資教室
                </p>
                <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 12px;">
                    <a href="https://vocus.cc/salon/655c9dbcfd897800019d5bb4" target="_blank"
                       rel="noopener noreferrer"
                       style="color: white; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                              padding: 8px 20px; border-radius: 20px; text-decoration: none;
                              font-weight: 600; transition: all 0.3s; display: inline-flex;
                              align-items: center; gap: 6px; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);"
                       onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(102, 126, 234, 0.4)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(102, 126, 234, 0.3)'"
                       aria-label="前往方格子部落格">
                        <span aria-hidden="true">📝</span>
                        <span>方格子部落格</span>
                    </a>
                    <a href="https://www.youtube.com/@rexdashu168" target="_blank"
                       rel="noopener noreferrer"
                       style="color: white; background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
                              padding: 8px 20px; border-radius: 20px; text-decoration: none;
                              font-weight: 600; transition: all 0.3s; display: inline-flex;
                              align-items: center; gap: 6px; box-shadow: 0 2px 8px rgba(255, 0, 0, 0.3);"
                       onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 12px rgba(255, 0, 0, 0.4)'"
                       onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 2px 8px rgba(255, 0, 0, 0.3)'"
                       aria-label="前往YouTube頻道">
                        <span aria-hidden="true">🎬</span>
                        <span>YouTube頻道</span>
                    </a>
                </div>
                <p style="font-size: 0.85rem; color: #6c757d;">更多投資觀念與可轉債分析，歡迎訂閱學習</p>
            </div>

            <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid #dee2e6;">
                <div style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap; margin-bottom: 8px;">
                    <div style="font-size: 0.9rem; color: #6c757d; display: flex; align-items: center; gap: 6px;">
                        <span aria-hidden="true">👁️</span>
                        <span>今日瀏覽：</span>
                        <strong style="color: #667eea; font-size: 1.1rem;" id="todayViews" aria-live="polite">0</strong>
                    </div>
                    <div style="font-size: 0.9rem; color: #6c757d; display: flex; align-items: center; gap: 6px;">
                        <span aria-hidden="true">📊</span>
                        <span>累積瀏覽：</span>
                        <strong style="color: #667eea; font-size: 1.1rem;" id="totalViews" aria-live="polite">0</strong>
                    </div>
                </div>
                <p style="font-size: 0.75rem; opacity: 0.7;">瀏覽量統計採用本地儲存，僅記錄您的瀏覽器訪問次數</p>
            </div>
        </footer>
    </main>

    <!-- JavaScript -->
    <script src="app.js"></script>

    <!-- 結構化資料 (Schema.org) for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "可轉債競拍查詢系統",
        "description": "提供2025年5-8月可轉債競拍資料查詢與分析",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "All",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "TWD"
        },
        "author": {
            "@type": "Person",
            "name": "Rex大叔"
        }
    }
    </script>
</body>
</html>
